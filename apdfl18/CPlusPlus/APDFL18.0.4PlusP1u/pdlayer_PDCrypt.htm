<!DOCTYPE html>
<html lang="en-US">
<head>
<link rel="stylesheet" href="styles.css">
<link rel="icon" type="image/x-icon" href="art/DLicon.png">
<meta charset="UTF-8">
<title>
PD Layer: PDCrypt</title>
</head>
<body>
<div>
<a href="index.htm"><img src="art/DL-Full-Logo-LightBG-Blue.svg" alt="DL Logo" style="height: 66px; border-bottom: 1px solid black; padding-bottom: 5px; width: auto; background: #ffffff; position: fixed; z-index: 1; top: 0px; left: 0px;"></a>
</div>
<div class="fullTOC"><iframe src="TOC.htm"></iframe></div>
<div class="objDoc"><nav><ul>
<h5>PD Layer: PDCrypt</h5>
<li><a href="#Definitions">Definitions</a></li>
<li><a href="#Enumerations">Enumerations</a></li>
<li><a href="#Typedefs">Typedefs</a></li>
<li><a href="#CallbackSignatures">Callback Signatures</a></li>
<li><a href="#Structures">Structures</a></li>
<li><a href="#Functions">Functions</a></li>
</ul></nav>
<section id="Definitions">
<header><h2>PDCrypt Definitions</h2></header>
<nav><dl>
<dt><a href="#PDCryptFilterStringProc">PDCryptFilterStringProc</a></dt><dd> - </dd>
</dl></nav>
<section><div class="infoRow"><h3 id="PDCryptFilterStringProc"><strong><span style="color:grey;">PDCryptFilterStringProc</span></strong></h3>

<div class="headerRef"><strong>Header:</strong> PDExpT.h:4960</div>
</div>

<H4><strong>Syntax</strong></H4>

<code><code>#define PDCryptFilterStringProc</code> <a href="coslayer_CosCrypt.htm#CosCryptStringProc" title=" A prototype for the string encryption/decryption callback."><code>CosCryptStringProc</code></a> </code>
</section>
</section>
<section id="Enumerations">
<header><h2>PDCrypt Enumerations</h2></header>
<nav><dl>
<dt><a href="#GCHTextType">GCHTextType</a></dt><dd> - </dd>
</dl></nav>
<section><div class="infoRow"><h3 id="GCHTextType"><strong><span style="color:grey;">GCHTextType</span></strong></h3>

<div class="headerRef"><strong>Header:</strong> PDExpT.h:4241</div>
</div>

<H4><strong>Enum Constants</strong></H4>

<table class="enumTable"><tr><td><span class="enumEntry" id="kGCHTTipText"><code>kGCHTTipText</code><code>=</code><code>1</code></span>
</td><td><span></span>
</td></tr>
<tr><td><span class="enumEntry" id="kGCHTMiniText"><code>kGCHTMiniText</code></span>
</td><td><span></span>
</td></tr>
<tr><td><span class="enumEntry" id="kGCHTLargeText"><code>kGCHTLargeText</code></span>
</td><td><span></span>
</td></tr></table>

<H4><strong>Used By</strong></H4>

<nav><table><tr><td><a href="pdlayer_PDCrypt.htm#PDCryptGetInfoTextProc" title=" (Optional) A callback for PDCryptHandler."><code>PDCryptGetInfoTextProc</code></a></td><td><span></span>
</td></tr></table>
</nav>
</section>
</section>
<section id="Typedefs">
<header><h2>PDCrypt Typedefs</h2></header>
<nav><dl>
<dt><a href="#PDCryptBatchHandler">PDCryptBatchHandler</a></dt><dd> - </dd>
<dt><a href="#PDCryptFilterHandler">PDCryptFilterHandler</a></dt><dd> - </dd>
<dt><a href="#PDCryptHandler">PDCryptHandler</a></dt><dd> - </dd>
</dl></nav>
<section><div class="infoRow"><h3 id="PDCryptBatchHandler"><strong><span style="color:grey;">PDCryptBatchHandler</span></strong></h3>

<div class="headerRef"><strong>Header:</strong> PDExpT.h:5092</div>
</div>

<H4><strong>Syntax</strong></H4>

<code><code>typedef</code> <code>struct</code> <a href="pdlayer_PDCrypt.htm#_t_PDCryptBatchHandler" title=" Callbacks used to open secured files and to modify security settings while batch processing a list of files."><code>_t_PDCryptBatchHandler</code></a> <code>*</code><code>PDCryptBatchHandler</code><code>;</code> </code>

<H4><strong>Used In</strong></H4>

<nav><table><tr><td><a href="pdlayer_PDCrypt.htm#_t_PDCryptHandler" title=" A data structure containing callbacks that implement a security handler."><code>_t_PDCryptHandler</code></a></td><td><span></span>
</td></tr></table>
</nav>
</section>
<section><div class="infoRow"><h3 id="PDCryptFilterHandler"><strong><span style="color:grey;">PDCryptFilterHandler</span></strong></h3>

<div class="headerRef"><strong>Header:</strong> PDExpT.h:4997</div>
</div>

<H4><strong>Syntax</strong></H4>

<code><code>typedef</code> <code>struct</code> <a href="pdlayer_PDCrypt.htm#_t_PDCryptFilterHandler" title=" PDCrypt Filter support."><code>_t_PDCryptFilterHandler</code></a> <code>*</code><code>PDCryptFilterHandler</code><code>;</code> </code>

<H4><strong>Used In</strong></H4>

<nav><table><tr><td><a href="pdlayer_PDCrypt.htm#_t_PDCryptHandler" title=" A data structure containing callbacks that implement a security handler."><code>_t_PDCryptHandler</code></a></td><td><span></span>
</td></tr></table>
</nav>
</section>
<section><div class="infoRow"><h3 id="PDCryptHandler"><strong><span style="color:grey;">PDCryptHandler</span></strong></h3>

<div class="headerRef"><strong>Header:</strong> PDExpT.h:5321</div>
</div>

<H4><strong>Syntax</strong></H4>

<code><code>typedef</code> <code>struct</code> <a href="pdlayer_PDCrypt.htm#_t_PDCryptHandler" title=" A data structure containing callbacks that implement a security handler."><code>_t_PDCryptHandler</code></a> <code>*</code><code>PDCryptHandler</code><code>;</code> </code>

<H4><strong>Used By</strong></H4>

<nav><table><tr><td><a href="pdlayer_PDCrypt.htm#PDRegisterCryptHandler" title=" Registers a new security handler with the Acrobat viewer."><code>PDRegisterCryptHandler</code></a></td><td><a href="pdlayer_PDCrypt.htm#PDRegisterCryptHandlerEx" title=" Registers a new security handler with the Acrobat viewer."><code>PDRegisterCryptHandlerEx</code></a></td></tr></table>
</nav>
</section>
</section>
<section id="CallbackSignatures">
<header><h2>PDCrypt Callback Signatures</h2></header>
<nav><dl>
<dt><a href="#PDCryptAuthorizeExProc">PDCryptAuthorizeExProc</a></dt><dd> -  Replaces PDCryptAuthorizeProc.</dd>
<dt><a href="#PDCryptAuthorizeProc">PDCryptAuthorizeProc</a></dt><dd> -  A callback for PDCryptHandler.</dd>
<dt><a href="#PDCryptBatchAuthorizeProc">PDCryptBatchAuthorizeProc</a></dt><dd> -  A callback for PDCryptBatchHandler.</dd>
<dt><a href="#PDCryptBatchFreeAuthDataProc">PDCryptBatchFreeAuthDataProc</a></dt><dd> -  A callback for PDCryptBatchHandler.</dd>
<dt><a href="#PDCryptBatchNewAuthDataProc">PDCryptBatchNewAuthDataProc</a></dt><dd> -  A callback for PDCryptBatchHandler.</dd>
<dt><a href="#PDCryptBatchParamDescProc">PDCryptBatchParamDescProc</a></dt><dd> -  A callback for PDCryptBatchHandler.</dd>
<dt><a href="#PDCryptBatchPostSequenceProc">PDCryptBatchPostSequenceProc</a></dt><dd> -  A callback for PDCryptBatchHandler.</dd>
<dt><a href="#PDCryptBatchPreSequenceProc">PDCryptBatchPreSequenceProc</a></dt><dd> -  A callback for PDCryptBatchHandler.</dd>
<dt><a href="#PDCryptBatchShowDialogProc">PDCryptBatchShowDialogProc</a></dt><dd> -  A callback for PDCryptBatchHandler.</dd>
<dt><a href="#PDCryptBatchUpdateSecurityDataProc">PDCryptBatchUpdateSecurityDataProc</a></dt><dd> -  A callback for PDCryptBatchHandler.</dd>
<dt><a href="#PDCryptCanParseEncryptDictProc">PDCryptCanParseEncryptDictProc</a></dt><dd> -  (Optional) This call is used to provide PDCrypt handler interoperability.</dd>
<dt><a href="#PDCryptDisplaySecurityDataProc">PDCryptDisplaySecurityDataProc</a></dt><dd> -  Called when the security handler should bring up a document (security) information dialog box with the current settings.</dd>
<dt><a href="#PDCryptEncryptDocMetadata">PDCryptEncryptDocMetadata</a></dt><dd> -  (Optional) A callback for PDCryptHandler.</dd>
<dt><a href="#PDCryptFillEncryptDictProc">PDCryptFillEncryptDictProc</a></dt><dd> -  A callback for PDCryptHandler.</dd>
<dt><a href="#PDCryptFilterAuthorizeProc">PDCryptFilterAuthorizeProc</a></dt><dd> -  (Optional) A callback for PDCryptFilterHandler.</dd>
<dt><a href="#PDCryptFilterGetDataProc">PDCryptFilterGetDataProc</a></dt><dd> -  (Optional) A callback for PDCryptFilterHandler.</dd>
<dt><a href="#PDCryptFilterStreamProc">PDCryptFilterStreamProc</a></dt><dd> -  (Optional) A callback for PDCryptFilterHandler.</dd>
<dt><a href="#PDCryptFreeAuthDataProc">PDCryptFreeAuthDataProc</a></dt><dd> -  (Optional) A callback for PDCryptHandler.</dd>
<dt><a href="#PDCryptFreeCryptDataProc">PDCryptFreeCryptDataProc</a></dt><dd> -  (Optional) A callback for PDCryptHandler.</dd>
<dt><a href="#PDCryptFreeSecurityDataProc">PDCryptFreeSecurityDataProc</a></dt><dd> -  (Optional) A callback for PDCryptHandler.</dd>
<dt><a href="#PDCryptGetAuthDataExProc">PDCryptGetAuthDataExProc</a></dt><dd> -  Replaces PDCryptGetAuthDataProc().</dd>
<dt><a href="#PDCryptGetAuthDataProc">PDCryptGetAuthDataProc</a></dt><dd> -  A callback for PDCryptHandler.</dd>
<dt><a href="#PDCryptGetDocPermsProc">PDCryptGetDocPermsProc</a></dt><dd> -  A callback for PDCryptHandler.</dd>
<dt><a href="#PDCryptGetInfoTextProc">PDCryptGetInfoTextProc</a></dt><dd> -  (Optional) A callback for PDCryptHandler.</dd>
<dt><a href="#PDCryptGetSecurityInfoProc">PDCryptGetSecurityInfoProc</a></dt><dd> -  (Optional) A callback for PDCryptHandler.</dd>
<dt><a href="#PDCryptNewAuthDataProc">PDCryptNewAuthDataProc</a></dt><dd> -  (Optional) A callback for PDCryptHandler.</dd>
<dt><a href="#PDCryptNewCryptDataExProc">PDCryptNewCryptDataExProc</a></dt><dd> -  A callback for PDCryptHandler.</dd>
<dt><a href="#PDCryptNewCryptDataProc">PDCryptNewCryptDataProc</a></dt><dd> -  A callback for PDCryptHandler.</dd>
<dt><a href="#PDCryptNewSecurityDataFromOriginalDocProc">PDCryptNewSecurityDataFromOriginalDocProc</a></dt><dd> -  Called when the application needs to open a rolled back portion of the original document.</dd>
<dt><a href="#PDCryptNewSecurityDataProc">PDCryptNewSecurityDataProc</a></dt><dd> -  (Optional) A callback for PDCryptHandler.</dd>
<dt><a href="#PDCryptReservedProc">PDCryptReservedProc</a></dt><dd> -  (Optional) A callback for PDCryptHandler.</dd>
<dt><a href="#PDCryptReservedProc2">PDCryptReservedProc2</a></dt><dd> -  (Optional) Used by Acrobat for Automated Permission Testing.</dd>
<dt><a href="#PDCryptUpdateSecurityDataProc">PDCryptUpdateSecurityDataProc</a></dt><dd> -  A callback for PDCryptHandler.</dd>
<dt><a href="#PDCryptValidateSecurityDataProc">PDCryptValidateSecurityDataProc</a></dt><dd> -  (Optional) A callback for PDCryptHandler.</dd>
</dl></nav>
<section><div class="infoRow"><h3 id="PDCryptAuthorizeExProc"><strong><span style="color:grey;">PDCryptAuthorizeExProc</span></strong></h3>

<div class="headerRef"><strong>Header:</strong> PDExpT.h:4608</div>
</div>

<div><div><H4><strong>Description</strong></H4>

<div><p>Replaces <a href="pdlayer_PDCrypt.htm#PDCryptAuthorizeProc" title=" A callback for PDCryptHandler.">PDCryptAuthorizeProc</a>. <a href="pdlayer_PDDoc.htm#PDPerms" title=" Constant values that specify permissions which allow operations on a document file.">PDPerms</a> are obsolete, but Acrobat still supports old security handlers.<br/>
<p>It is called whenever Acrobat needs to get authorization data and/or check permissions for operations.<br/></p>
</div>
</div>

<div class="relatedMethods"><H4><strong>Related Methods</strong></H4>

<a href="pdlayer_PDCrypt.htm#PDCryptAuthorizeProc" title=" A callback for PDCryptHandler."><code>PDCryptAuthorizeProc</code></a>
<a href="pdlayer_PDDoc.htm#PDDocPermRequest" title=" This method supersedes PDDocGetPermissions()."><code>PDDocPermRequest</code></a></div>
</div>

<H4><strong>Syntax</strong></H4>

<code><a href="pdlayer_PDDoc.htm#PDPermReqStatus" title=" The set of valid PDPermRequestStatus values providing the status of PDDoc-related permissions methods."><code>PDPermReqStatus</code></a> <code>PDCryptAuthorizeExProc(</code><a href="pdlayer_PDDoc.htm#PDDoc" title=" The underlying PDF representation of a document."><code>PDDoc</code></a> <code>pdDoc</code><code>,</code> <a href="pdlayer_PDDoc.htm#PDPermReqObj" title=" The document object type."><code>PDPermReqObj</code></a> <code>reqObj</code><code>,</code> <a href="pdlayer_PDDoc.htm#PDPermReqOpr" title=" An enumerated data type used to describe the target operation of a permissions request."><code>PDPermReqOpr</code></a> <code>reqOpr</code><code>,</code> <code>void</code> <code>*</code><code>authData</code><code>);</code> </code>

<H4><strong>Parameters</strong></H4>

<Table class="paramsTable"><tr><td><span><code>pdDoc</code></span>
</td><td><span>The document for which the request is made. </span>
</td></tr>
<tr><td><span><code>reqObj</code></span>
</td><td><span>The object type that is the focus of the request: it is one of the <a href="pdlayer_PDDoc.htm#PDPermReqObj" title=" The document object type.">PDPermReqObj</a> values. </span>
</td></tr>
<tr><td><span><code>reqOpr</code></span>
</td><td><span>The operation type that is the focus of the request: it is one of the <a href="pdlayer_PDDoc.htm#PDPermReqOpr" title=" An enumerated data type used to describe the target operation of a permissions request.">PDPermReqOpr</a> values. </span>
</td></tr>
<tr><td><span><code>authData</code></span>
</td><td><span>Authorization data. Its format is security handler-specific. </span>
</td></tr></Table>

<H4><strong>Returns</strong></H4>

<span>The status of the request. It is one of the <a href="pdlayer_PDDoc.htm#PDPermReqStatus" title=" The set of valid PDPermRequestStatus values providing the status of PDDoc-related permissions methods.">PDPermReqStatus</a> values. </span>

<H4><strong>Used In</strong></H4>

<nav><table><tr><td><a href="pdlayer_PDCrypt.htm#_t_PDCryptHandler" title=" A data structure containing callbacks that implement a security handler."><code>_t_PDCryptHandler</code></a></td><td><span></span>
</td></tr></table>
</nav>
</section>
<section><div class="infoRow"><h3 id="PDCryptAuthorizeProc"><strong><span style="color:grey;">PDCryptAuthorizeProc</span></strong></h3>

<div class="headerRef"><strong>Header:</strong> PDExpT.h:4299</div>
</div>

<div><div><H4><strong>Description</strong></H4>

<div><p>A callback for <a href="pdlayer_PDCrypt.htm#_t_PDCryptHandler">PDCryptHandler</a>. It is called by <a href="pdlayer_PDDoc.htm#PDDocAuthorize" title=" Deprecated in Acrobat 7.0. Use PDDocPermRequest() instead.">PDDocAuthorize</a>() when a user tries to set security for an encrypted document and by a <a href="pdlayer_PDDoc.htm#PDAuthProc">PDAuthProc</a>() when a user tries to open a file.<br/>
<p>It must decide, based on the contents of the authorization data structure, whether the user is permitted to open the file, and what permissions the user has for this file. The authorization data structure is available for making this decision. Alternate implementations may not require authorization data and may, for example, make authorization decisions based on data contained in the security data structure (use <a href="pdlayer_PDCrypt.htm#PDCryptNewSecurityDataProc" title=" (Optional) A callback for PDCryptHandler.">PDCryptNewSecurityDataProc</a>()).<br/></p>

<p>
<p>This callback must not obtain the authorization data (for example, by displaying a user interface into which a user can type a password). Obtaining authorization data is handled by the security handler's <a href="pdlayer_PDCrypt.htm#PDCryptGetAuthDataProc" title=" A callback for PDCryptHandler.">PDCryptGetAuthDataProc</a>(), which must be called before this callback. Instead, <a href="pdlayer_PDCrypt.htm#PDCryptAuthorizeProc" title=" A callback for PDCryptHandler.">PDCryptAuthorizeProc</a>() must work with whatever authorization data is passed to it.<br/></p>

<p>
<p>It is legitimate for this callback to be called with <a href="aslayer_General.htm#NULL"><code>NULL</code></a> authorization data; the Acrobat viewer's built-in <code>authProc</code> does this in order to support authorization methods that do not require authorization data.<br/></p>

<p>
<p>When this callback is invoked to determine whether a user is permitted to open a file, <code>permWanted</code> is set to <a href="pdlayer_PDDoc.htm#pdPermOpen" title=" The user can open and decrypt the document."><code>pdPermOpen</code></a>. In this case, the file's contents are not yet decrypted (since this callback is being asked to permit decryption), and some calls must be avoided. For example, a call that causes a page to be parsed results in an error, since the encrypted contents are parsed. In general, it is safe to obtain information about the presence or absence of things, or the number of things, and to examine any part of a document at the Cos level.<br/></p>
</div>
</div>

<div class="relatedMethods"><H4><strong>Related Methods</strong></H4>

<a href="pdlayer_PDCrypt.htm#PDCryptAuthorizeExProc" title=" Replaces PDCryptAuthorizeProc."><code>PDCryptAuthorizeExProc</code></a>
<a href="pdlayer_PDCrypt.htm#PDCryptAuthorizeFilterAccess" title=" Gets authorization to encrypt or decrypt an embedded file, where that file's cryptographic filter is not the one used to open the document in which the file is embedded."><code>PDCryptAuthorizeFilterAccess</code></a>
<a href="pdlayer_PDDoc.htm#PDDocAuthorize" title=" Deprecated in Acrobat 7.0. Use PDDocPermRequest() instead."><code>PDDocAuthorize</code></a>
<a href="pdlayer_PDDoc.htm#PDDocOpen" title=" Opens the specified document."><code>PDDocOpen</code></a>
<a href="pdlayer_PDDoc.htm#PDDocOpenEx" title=" Opens the specified document."><code>PDDocOpenEx</code></a></div>
</div>

<H4><strong>Syntax</strong></H4>

<code><a href="pdlayer_PDDoc.htm#PDPerms" title=" Constant values that specify permissions which allow operations on a document file."><code>PDPerms</code></a> <code>PDCryptAuthorizeProc(</code><a href="pdlayer_PDDoc.htm#PDDoc" title=" The underlying PDF representation of a document."><code>PDDoc</code></a> <code>pdDoc</code><code>,</code> <code>void</code> <code>*</code><code>authData</code><code>,</code> <a href="pdlayer_PDDoc.htm#PDPerms" title=" Constant values that specify permissions which allow operations on a document file."><code>PDPerms</code></a> <code>permWanted</code><code>);</code> </code>

<H4><strong>Parameters</strong></H4>

<Table class="paramsTable"><tr><td><span><code>pdDoc</code></span>
</td><td><span>The document for which authorized permissions are being requested. </span>
</td></tr>
<tr><td><span><code>authData</code></span>
</td><td><span>Authorization data. Its format is security handler-specific; each handler can select its own authorization data format. </span>
</td></tr>
<tr><td><span><code>permWanted</code></span>
</td><td><span>The permissions being requested. It is either <a href="pdlayer_PDDoc.htm#pdPermOpen" title=" The user can open and decrypt the document."><code>pdPermOpen</code></a> (if the file is being opened) or <a href="pdlayer_PDDoc.htm#pdPermSecure" title=" The user can change the document's security settings."><code>pdPermSecure</code></a> (if a request is being made to change the document's security settings). </span>
</td></tr></Table>

<H4><strong>Returns</strong></H4>

<span>The permissions granted based on <code>authData</code>. For opening, the permissions returned usually should be <a href="pdlayer_PDDoc.htm#pdPermOpen" title=" The user can open and decrypt the document."><code>pdPermOpen</code></a> and some or all of <a href="pdlayer_PDDoc.htm#pdPermPrint" title=" The user can print the document."><code>pdPermPrint</code></a>, <a href="pdlayer_PDDoc.htm#pdPermEdit" title=" The user can edit the document more than adding or modifying text notes (see also pdPermEditNotes)."><code>pdPermEdit</code></a>, and <a href="pdlayer_PDDoc.htm#pdPermCopy" title=" The user can copy information from the document to the clipboard."><code>pdPermCopy</code></a>. For setting security, permissions returned should be <a href="pdlayer_PDDoc.htm#pdPermAll"><code>pdPermAll</code></a>. However, if authorization fails, <code>0</code> should be returned. </span>

<H4><strong>Used In</strong></H4>

<nav><table><tr><td><a href="pdlayer_PDCrypt.htm#_t_PDCryptHandler" title=" A data structure containing callbacks that implement a security handler."><code>_t_PDCryptHandler</code></a></td><td><span></span>
</td></tr></table>
</nav>
</section>
<section><div class="infoRow"><h3 id="PDCryptBatchAuthorizeProc"><strong><span style="color:grey;">PDCryptBatchAuthorizeProc</span></strong></h3>

<div class="headerRef"><strong>Header:</strong> PDExpT.h:4823</div>
</div>

<div><H4><strong>Description</strong></H4>

<span>A callback for <a href="pdlayer_PDCrypt.htm#_t_PDCryptBatchHandler">PDCryptBatchHandler</a>. It is called when a PDF file is opened. It is first called with <a href="aslayer_General.htm#NULL"><code>NULL</code></a> <code>authData</code> for the case without a user password. It is called again with authorization data provided for the security handler that matches the one used in the PDF file. </span>

<p class="note"><strong><span style="color:red;">Note:</span></strong> This function is called a batch operation and therefore should not display any user interface. During a batch operation, a file will first be opened with the <a href="pdlayer_PDDoc.htm#pdPermSecure" title=" The user can change the document's security settings."><code>pdPermSecure</code></a> bit set. It will then be opened with the <a href="pdlayer_PDDoc.htm#pdPermOpen" title=" The user can open and decrypt the document."><code>pdPermOpen</code></a> bit set. </p>
</div>

<H4><strong>Syntax</strong></H4>

<code><a href="pdlayer_PDDoc.htm#PDPermReqStatus" title=" The set of valid PDPermRequestStatus values providing the status of PDDoc-related permissions methods."><code>PDPermReqStatus</code></a> <code>PDCryptBatchAuthorizeProc(</code><a href="pdlayer_PDDoc.htm#PDDoc" title=" The underlying PDF representation of a document."><code>PDDoc</code></a> <code>pdDoc</code><code>,</code> <a href="pdlayer_PDDoc.htm#PDPermReqObj" title=" The document object type."><code>PDPermReqObj</code></a> <code>reqObj</code><code>,</code> <a href="pdlayer_PDDoc.htm#PDPermReqOpr" title=" An enumerated data type used to describe the target operation of a permissions request."><code>PDPermReqOpr</code></a> <code>reqOpr</code><code>,</code> <code>void</code> <code>*</code><code>authData</code><code>);</code> </code>

<H4><strong>Parameters</strong></H4>

<Table class="paramsTable"><tr><td><span><code>pdDoc</code></span>
</td><td><span>IN/OUT The document being opened. </span>
</td></tr>
<tr><td><span><code>reqObj</code></span>
</td><td><span>IN/OUT The object type that is the focus of the request: it is one of the <a href="pdlayer_PDDoc.htm#PDPermReqObj" title=" The document object type.">PDPermReqObj</a> values. </span>
</td></tr>
<tr><td><span><code>reqOpr</code></span>
</td><td><span>IN/OUT The operation type that is the focus of the request: it is one of the <a href="pdlayer_PDDoc.htm#PDPermReqOpr" title=" An enumerated data type used to describe the target operation of a permissions request.">PDPermReqOpr</a> values. </span>
</td></tr>
<tr><td><span><code>authData</code></span>
</td><td><span>IN/OUT Authorization data. Its format is security handler-specific. </span>
</td></tr></Table>

<H4><strong>Returns</strong></H4>

<span><a href="pdlayer_PDDoc.htm#PDPermReqStatus" title=" The set of valid PDPermRequestStatus values providing the status of PDDoc-related permissions methods.">PDPermReqStatus</a> </span>

<H4><strong>Used In</strong></H4>

<nav><table><tr><td><a href="pdlayer_PDCrypt.htm#_t_PDCryptBatchHandler" title=" Callbacks used to open secured files and to modify security settings while batch processing a list of files."><code>_t_PDCryptBatchHandler</code></a></td><td><span></span>
</td></tr></table>
</nav>
</section>
<section><div class="infoRow"><h3 id="PDCryptBatchFreeAuthDataProc"><strong><span style="color:grey;">PDCryptBatchFreeAuthDataProc</span></strong></h3>

<div class="headerRef"><strong>Header:</strong> PDExpT.h:4834</div>
</div>

<div><H4><strong>Description</strong></H4>

<span>A callback for <a href="pdlayer_PDCrypt.htm#_t_PDCryptBatchHandler">PDCryptBatchHandler</a>. If provided, it must be used to free <code>authData</code> acquired via BatchGetAuthData() or BatchNewAuthData(). If no BatchFreeAuthData() function is provided, a default one will be used which calls <a href="aslayer_ASMem.htm#ASfree" title=" Frees the specified memory block.">ASfree</a>() on the <code>authData</code> if it is non- <a href="aslayer_General.htm#NULL"><code>NULL</code></a>. </span>
</div>

<H4><strong>Syntax</strong></H4>

<code><code>void</code> <code>PDCryptBatchFreeAuthDataProc(</code><code>void</code> <code>*</code><code>authData</code><code>);</code> </code>

<H4><strong>Parameters</strong></H4>

<Table class="paramsTable"><tr><td><span><code>authData</code></span>
</td><td><span>IN/OUT Authorization data. Its format is security handler-specific. </span>
</td></tr></Table>

<H4><strong>Used In</strong></H4>

<nav><table><tr><td><a href="pdlayer_PDCrypt.htm#_t_PDCryptBatchHandler" title=" Callbacks used to open secured files and to modify security settings while batch processing a list of files."><code>_t_PDCryptBatchHandler</code></a></td><td><span></span>
</td></tr></table>
</nav>
</section>
<section><div class="infoRow"><h3 id="PDCryptBatchNewAuthDataProc"><strong><span style="color:grey;">PDCryptBatchNewAuthDataProc</span></strong></h3>

<div class="headerRef"><strong>Header:</strong> PDExpT.h:4802</div>
</div>

<div><H4><strong>Description</strong></H4>

<span>A callback for <a href="pdlayer_PDCrypt.htm#_t_PDCryptBatchHandler">PDCryptBatchHandler</a>. It is different from the regular <a href="pdlayer_PDCrypt.htm#_t_PDCryptHandler">PDCryptHandler</a> <code>NewAuthData</code> function. It creates and returns a <code>void</code> <code>*</code> which is the authorization data for the batch security handler. This data should be used to batch both open files and secure files. Therefore, make sure to provide password information for both the <a href="pdlayer_PDDoc.htm#pdPermOpen" title=" The user can open and decrypt the document."><code>pdPermOpen</code></a> and <a href="pdlayer_PDDoc.htm#pdPermSecure" title=" The user can change the document's security settings."><code>pdPermSecure</code></a> cases. This data will be passed to the <a href="pdlayer_PDCrypt.htm#PDCryptBatchAuthorizeProc" title=" A callback for PDCryptBatchHandler.">PDCryptBatchAuthorizeProc</a>() callback and eventually to <a href="pdlayer_PDCrypt.htm#PDCryptBatchFreeAuthDataProc" title=" A callback for PDCryptBatchHandler.">PDCryptBatchFreeAuthDataProc</a>() to free the data. This authorization data is collected before any files are opened in the batch sequence. It is permitted to display a user interface at this point since the batch operation has not started yet. The data applies to all files, and therefore could represent one or more passwords which can be enumerated in the <code>BatchAuthorize</code> function which receives the batch authorization data. </span>
</div>

<H4><strong>Syntax</strong></H4>

<code><code>void</code> <code>*</code><code>PDCryptBatchNewAuthDataProc(</code><code>void</code><code>);</code> </code>

<H4><strong>Used In</strong></H4>

<nav><table><tr><td><a href="pdlayer_PDCrypt.htm#_t_PDCryptBatchHandler" title=" Callbacks used to open secured files and to modify security settings while batch processing a list of files."><code>_t_PDCryptBatchHandler</code></a></td><td><span></span>
</td></tr></table>
</nav>
</section>
<section><div class="infoRow"><h3 id="PDCryptBatchParamDescProc"><strong><span style="color:grey;">PDCryptBatchParamDescProc</span></strong></h3>

<div class="headerRef"><strong>Header:</strong> PDExpT.h:4784</div>
</div>

<div><H4><strong>Description</strong></H4>

<span>A callback for <a href="pdlayer_PDCrypt.htm#_t_PDCryptBatchHandler">PDCryptBatchHandler</a>. The developer should provide information about the current batch settings for the security handler. Batch settings are provided as a read-only <a href="aslayer_ASCab.htm#ASCab" title=" ASCab objects ( cabinets ) can be used to store arbitrary key/value pairs.">ASCab</a> that is passed to the function. A writable <a href="aslayer_ASCab.htm#ASCab" title=" ASCab objects ( cabinets ) can be used to store arbitrary key/value pairs.">ASCab</a> is also provided, which should be used to store parameter information about the security handler. The description information should be stored starting in the <code>paramDesc</code> <a href="aslayer_ASCab.htm#ASCab" title=" ASCab objects ( cabinets ) can be used to store arbitrary key/value pairs.">ASCab</a> using <a href="aslayer_ASText.htm#ASText" title=" An opaque object holding encoded text.">ASText</a> objects starting with key <code>"</code> <code>1"</code>. </span>
</div>

<H4><strong>Syntax</strong></H4>

<code><code>void</code> <code>PDCryptBatchParamDescProc(</code><code>const</code> <a href="aslayer_ASCab.htm#ASCab" title=" ASCab objects ( cabinets ) can be used to store arbitrary key/value pairs."><code>ASCab</code></a> <code>settings</code><code>,</code> <a href="aslayer_ASCab.htm#ASCab" title=" ASCab objects ( cabinets ) can be used to store arbitrary key/value pairs."><code>ASCab</code></a> <code>paramDesc</code><code>);</code> </code>

<H4><strong>Parameters</strong></H4>

<Table class="paramsTable"><tr><td><span><code>settings</code></span>
</td><td><span>IN/OUT Batch settings. </span>
</td></tr>
<tr><td><span><code>paramDesc</code></span>
</td><td><span>IN/OUT Description information. </span>
</td></tr></Table>

<H4><strong>Example</strong></H4>

<span><code>key="</code> <code>1",</code> <code>value="Title:</code> <code>API</code> <code>Reference"</code> (ASText object) </span>

<H4><strong>Used In</strong></H4>

<nav><table><tr><td><a href="pdlayer_PDCrypt.htm#_t_PDCryptBatchHandler" title=" Callbacks used to open secured files and to modify security settings while batch processing a list of files."><code>_t_PDCryptBatchHandler</code></a></td><td><span></span>
</td></tr></table>
</nav>
</section>
<section><div class="infoRow"><h3 id="PDCryptBatchPostSequenceProc"><strong><span style="color:grey;">PDCryptBatchPostSequenceProc</span></strong></h3>

<div class="headerRef"><strong>Header:</strong> PDExpT.h:4860</div>
</div>

<div><H4><strong>Description</strong></H4>

<span>A callback for <a href="pdlayer_PDCrypt.htm#_t_PDCryptBatchHandler">PDCryptBatchHandler</a>. This function is called at the end of a batch sequence after all files have been processed. Any memory that was allocated in the BatchPreSequence() call should be cleaned up in this callback. </span>
</div>

<H4><strong>Syntax</strong></H4>

<code><code>void</code> <code>PDCryptBatchPostSequenceProc(</code><a href="aslayer_ASCab.htm#ASCab" title=" ASCab objects ( cabinets ) can be used to store arbitrary key/value pairs."><code>ASCab</code></a> <code>settings</code><code>);</code> </code>

<H4><strong>Parameters</strong></H4>

<Table class="paramsTable"><tr><td><span><code>settings</code></span>
</td><td><span>IN/OUT Batch settings. </span>
</td></tr></Table>

<H4><strong>Used In</strong></H4>

<nav><table><tr><td><a href="pdlayer_PDCrypt.htm#_t_PDCryptBatchHandler" title=" Callbacks used to open secured files and to modify security settings while batch processing a list of files."><code>_t_PDCryptBatchHandler</code></a></td><td><span></span>
</td></tr></table>
</nav>
</section>
<section><div class="infoRow"><h3 id="PDCryptBatchPreSequenceProc"><strong><span style="color:grey;">PDCryptBatchPreSequenceProc</span></strong></h3>

<div class="headerRef"><strong>Header:</strong> PDExpT.h:4852</div>
</div>

<div><H4><strong>Description</strong></H4>

<span>A callback for <a href="pdlayer_PDCrypt.htm#_t_PDCryptBatchHandler">PDCryptBatchHandler</a>. This function is called at the beginning of a batch sequence before any files have been opened. This allows a security handler to be called back with the <a href="aslayer_ASCab.htm#ASCab" title=" ASCab objects ( cabinets ) can be used to store arbitrary key/value pairs.">ASCab</a> of settings that were filled out by the BatchShowDialog() function, or by an <a href="aslayer_ASCab.htm#ASCab" title=" ASCab objects ( cabinets ) can be used to store arbitrary key/value pairs.">ASCab</a> that was read in from disk. Pointers of security information are not serialized to disk, and therefore a security information structure may need to be regenerated based on other security information in the <a href="aslayer_ASCab.htm#ASCab" title=" ASCab objects ( cabinets ) can be used to store arbitrary key/value pairs.">ASCab</a>. It is permitted for the BatchPreSequence() callback to put up a user interface asking the user for more information since the batch sequence has not started yet. If this function returns <a href="aslayer_General.htm#false"><code>false</code></a>, the viewer will assume that the command cannot be executed and will cancel the sequence. </span>
</div>

<H4><strong>Syntax</strong></H4>

<code><a href="aslayer_General.htm#ASBool" title=" ASBool"><code>ASBool</code></a> <code>PDCryptBatchPreSequenceProc(</code><a href="aslayer_ASCab.htm#ASCab" title=" ASCab objects ( cabinets ) can be used to store arbitrary key/value pairs."><code>ASCab</code></a> <code>settings</code><code>);</code> </code>

<H4><strong>Parameters</strong></H4>

<Table class="paramsTable"><tr><td><span><code>settings</code></span>
</td><td><span>IN/OUT Batch settings. </span>
</td></tr></Table>

<H4><strong>Returns</strong></H4>

<span>See above. </span>

<H4><strong>Used In</strong></H4>

<nav><table><tr><td><a href="pdlayer_PDCrypt.htm#_t_PDCryptBatchHandler" title=" Callbacks used to open secured files and to modify security settings while batch processing a list of files."><code>_t_PDCryptBatchHandler</code></a></td><td><span></span>
</td></tr></table>
</nav>
</section>
<section><div class="infoRow"><h3 id="PDCryptBatchShowDialogProc"><strong><span style="color:grey;">PDCryptBatchShowDialogProc</span></strong></h3>

<div class="headerRef"><strong>Header:</strong> PDExpT.h:4770</div>
</div>

<div><H4><strong>Description</strong></H4>

<span>A callback for <a href="pdlayer_PDCrypt.htm#_t_PDCryptBatchHandler">PDCryptBatchHandler</a>. This callback puts up a dialog box that allows a user to enter data that will be used to batch secure a series of files. The data is stored in an <a href="aslayer_ASCab.htm#ASCab" title=" ASCab objects ( cabinets ) can be used to store arbitrary key/value pairs.">ASCab</a> which is part of a batch sequence file. The actual security data, including password(s), should be stored as a pointer in the <a href="aslayer_ASCab.htm#ASCab" title=" ASCab objects ( cabinets ) can be used to store arbitrary key/value pairs.">ASCab</a> so that password information is not serialized to disk. Pointers are not serialized from <a href="aslayer_ASCab.htm#ASCab" title=" ASCab objects ( cabinets ) can be used to store arbitrary key/value pairs.">ASCab</a> objects, but <a href="aslayer_ASText.htm#ASText" title=" An opaque object holding encoded text.">ASText</a> objects, <a href="aslayer_General.htm#ASInt32" title=" 4-byte signed long numeric value.">ASInt32</a> objects, and <a href="aslayer_General.htm#ASBool" title=" ASBool">ASBool</a> objects are serialized. </span>
</div>

<H4><strong>Syntax</strong></H4>

<code><a href="aslayer_General.htm#ASBool" title=" ASBool"><code>ASBool</code></a> <code>PDCryptBatchShowDialogProc(</code><a href="aslayer_ASCab.htm#ASCab" title=" ASCab objects ( cabinets ) can be used to store arbitrary key/value pairs."><code>ASCab</code></a> <code>settings</code><code>);</code> </code>

<H4><strong>Parameters</strong></H4>

<Table class="paramsTable"><tr><td><span><code>settings</code></span>
</td><td><span>IN/OUT An object of type <a href="aslayer_ASCab.htm#ASCab" title=" ASCab objects ( cabinets ) can be used to store arbitrary key/value pairs.">ASCab</a>. </span>
</td></tr></Table>

<H4><strong>Returns</strong></H4>

<span><a href="aslayer_General.htm#true"><code>true</code></a> indicates success. </span>

<H4><strong>Used In</strong></H4>

<nav><table><tr><td><a href="pdlayer_PDCrypt.htm#_t_PDCryptBatchHandler" title=" Callbacks used to open secured files and to modify security settings while batch processing a list of files."><code>_t_PDCryptBatchHandler</code></a></td><td><span></span>
</td></tr></table>
</nav>
</section>
<section><div class="infoRow"><h3 id="PDCryptBatchUpdateSecurityDataProc"><strong><span style="color:grey;">PDCryptBatchUpdateSecurityDataProc</span></strong></h3>

<div class="headerRef"><strong>Header:</strong> PDExpT.h:4877</div>
</div>

<div><H4><strong>Description</strong></H4>

<span>A callback for <a href="pdlayer_PDCrypt.htm#_t_PDCryptBatchHandler">PDCryptBatchHandler</a>. This function should update the crypt handler's security data without bringing up a dialog. This data is provided by a <a href="pdlayer_PDCrypt.htm#PDCryptBatchShowDialogProc" title=" A callback for PDCryptBatchHandler.">PDCryptBatchShowDialogProc</a>(). The current security data can be obtained by calling <a href="pdlayer_PDDoc.htm#PDDocGetNewSecurityData" title=" Gets the security data structure for the specified document's new security handler.">PDDocGetNewSecurityData</a>(). </span>

<p class="note"><strong><span style="color:red;">Note:</span></strong> This function is called a batch operation and therefore should not display any user interface. </p>
</div>

<H4><strong>Syntax</strong></H4>

<code><a href="aslayer_General.htm#ASBool" title=" ASBool"><code>ASBool</code></a> <code>PDCryptBatchUpdateSecurityDataProc(</code><a href="pdlayer_PDDoc.htm#PDDoc" title=" The underlying PDF representation of a document."><code>PDDoc</code></a> <code>pdDoc</code><code>,</code> <a href="aslayer_ASCab.htm#ASCab" title=" ASCab objects ( cabinets ) can be used to store arbitrary key/value pairs."><code>ASCab</code></a> <code>settings</code><code>,</code> <a href="aslayer_ASAtom.htm#ASAtom"><code>ASAtom</code></a> <code>*</code><code>cryptHandler</code><code>,</code> <code>void</code> <code>*</code><code>*</code><code>secDataP</code><code>);</code> </code>

<H4><strong>Parameters</strong></H4>

<Table class="paramsTable"><tr><td><span><code>pdDoc</code></span>
</td><td><span>The document whose data is updated. </span>
</td></tr>
<tr><td><span><code>settings</code></span>
</td><td><span>An object of type <a href="aslayer_ASCab.htm#ASCab" title=" ASCab objects ( cabinets ) can be used to store arbitrary key/value pairs.">ASCab</a>. </span>
</td></tr>
<tr><td><span><code>cryptHandler</code></span>
</td><td><span>An object of type <a href="aslayer_ASAtom.htm#ASAtom">ASAtom</a>. </span>
</td></tr>
<tr><td><span><code>secDataP</code></span>
</td><td><span>A pointer to the document's security data. </span>
</td></tr></Table>

<H4><strong>Returns</strong></H4>

<span>This function should return <a href="aslayer_General.htm#true"><code>true</code></a> unless there is a problem with the batch data for this security handler. </span>

<H4><strong>Used In</strong></H4>

<nav><table><tr><td><a href="pdlayer_PDCrypt.htm#_t_PDCryptBatchHandler" title=" Callbacks used to open secured files and to modify security settings while batch processing a list of files."><code>_t_PDCryptBatchHandler</code></a></td><td><span></span>
</td></tr></table>
</nav>
</section>
<section><div class="infoRow"><h3 id="PDCryptCanParseEncryptDictProc"><strong><span style="color:grey;">PDCryptCanParseEncryptDictProc</span></strong></h3>

<div class="headerRef"><strong>Header:</strong> PDExpT.h:4690</div>
</div>

<div><H4><strong>Description</strong></H4>

<span>(Optional) This call is used to provide PDCrypt handler interoperability. When an encrypted document is being opened and the security handler specified in the encryption dictionary is not present, this callback is used to determine if one of the registered security handlers can be used to open the document. </span>
</div>

<H4><strong>Syntax</strong></H4>

<code><a href="aslayer_General.htm#ASBool" title=" ASBool"><code>ASBool</code></a> <code>PDCryptCanParseEncryptDictProc(</code><a href="pdlayer_PDDoc.htm#PDDoc" title=" The underlying PDF representation of a document."><code>PDDoc</code></a> <code>pdDoc</code><code>,</code> <a href="coslayer_CosObj.htm#CosObj"><code>CosObj</code></a> <code>encryptDict</code><code>);</code> </code>

<H4><strong>Parameters</strong></H4>

<Table class="paramsTable"><tr><td><span><code>pdDoc</code></span>
</td><td><span>The document being opened. </span>
</td></tr>
<tr><td><span><code>encryptDict</code></span>
</td><td><span>The encryption dictionary. </span>
</td></tr></Table>

<H4><strong>Returns</strong></H4>

<span><a href="aslayer_General.htm#true"><code>true</code></a> if the handler supports the format of <code>encryptDict</code>. </span>

<H4><strong>Used In</strong></H4>

<nav><table><tr><td><a href="pdlayer_PDCrypt.htm#_t_PDCryptHandler" title=" A data structure containing callbacks that implement a security handler."><code>_t_PDCryptHandler</code></a></td><td><span></span>
</td></tr></table>
</nav>
</section>
<section><div class="infoRow"><h3 id="PDCryptDisplaySecurityDataProc"><strong><span style="color:grey;">PDCryptDisplaySecurityDataProc</span></strong></h3>

<div class="headerRef"><strong>Header:</strong> PDExpT.h:4672</div>
</div>

<div><H4><strong>Description</strong></H4>

<div><p>Called when the security handler should bring up a document (security) information dialog box with the current settings. It also should return <a href="aslayer_General.htm#true"><code>true</code></a> when the user wants to change the settings.<br/>
<p>If this callback is not supplied, the default information dialog is displayed with <a href="pdlayer_PDDoc.htm#PDPerms" title=" Constant values that specify permissions which allow operations on a document file.">PDPerms</a> bits information (an Acrobat 4.x-equivalent dialog).<br/></p>
</div>
</div>

<H4><strong>Syntax</strong></H4>

<code><a href="aslayer_General.htm#ASBool" title=" ASBool"><code>ASBool</code></a> <code>PDCryptDisplaySecurityDataProc(</code><a href="pdlayer_PDDoc.htm#PDDoc" title=" The underlying PDF representation of a document."><code>PDDoc</code></a> <code>pdDoc</code><code>,</code> <a href="aslayer_ASAtom.htm#ASAtom"><code>ASAtom</code></a> <code>cryptHandler</code><code>);</code> </code>

<H4><strong>Parameters</strong></H4>

<Table class="paramsTable"><tr><td><span><code>pdDoc</code></span>
</td><td><span>IN/OUT The document whose information is displayed. </span>
</td></tr>
<tr><td><span><code>cryptHandler</code></span>
</td><td><span>IN/OUT The registered name of the handler. </span>
</td></tr></Table>

<H4><strong>Returns</strong></H4>

<span><a href="aslayer_General.htm#true"><code>true</code></a> if the handler wishes a callback to change the settings, <a href="aslayer_General.htm#false"><code>false</code></a> otherwise. </span>

<H4><strong>Used In</strong></H4>

<nav><table><tr><td><a href="pdlayer_PDCrypt.htm#_t_PDCryptHandler" title=" A data structure containing callbacks that implement a security handler."><code>_t_PDCryptHandler</code></a></td><td><span></span>
</td></tr></table>
</nav>
</section>
<section><div class="infoRow"><h3 id="PDCryptEncryptDocMetadata"><strong><span style="color:grey;">PDCryptEncryptDocMetadata</span></strong></h3>

<div class="headerRef"><strong>Header:</strong> PDExpT.h:4732</div>
</div>

<div><H4><strong>Description</strong></H4>

<span>(Optional) A callback for <a href="pdlayer_PDCrypt.htm#_t_PDCryptHandler">PDCryptHandler</a>. It determines whether a document's metadata will be encrypted. If this call is not implemented, the metadata is always encrypted. Note that documents with plain text metadata can be opened only by Acrobat versions 6.0 and later. </span>
</div>

<H4><strong>Syntax</strong></H4>

<code><a href="aslayer_General.htm#ASBool" title=" ASBool"><code>ASBool</code></a> <code>PDCryptEncryptDocMetadata(</code><a href="pdlayer_PDDoc.htm#PDDoc" title=" The underlying PDF representation of a document."><code>PDDoc</code></a> <code>pdDoc</code><code>);</code> </code>

<H4><strong>Parameters</strong></H4>

<Table class="paramsTable"><tr><td><span><code>pdDoc</code></span>
</td><td><span><a href="pdslayer_General.htm#IN">IN</a> The document being encrypted. </span>
</td></tr></Table>

<H4><strong>Returns</strong></H4>

<span><a href="aslayer_General.htm#true"><code>true</code></a> if document metadata should be encrypted. </span>

<H4><strong>Used In</strong></H4>

<nav><table><tr><td><a href="pdlayer_PDCrypt.htm#_t_PDCryptHandler" title=" A data structure containing callbacks that implement a security handler."><code>_t_PDCryptHandler</code></a></td><td><span></span>
</td></tr></table>
</nav>
</section>
<section><div class="infoRow"><h3 id="PDCryptFillEncryptDictProc"><strong><span style="color:grey;">PDCryptFillEncryptDictProc</span></strong></h3>

<div class="headerRef"><strong>Header:</strong> PDExpT.h:4504</div>
</div>

<div><div><H4><strong>Description</strong></H4>

<div><p>A callback for <a href="pdlayer_PDCrypt.htm#_t_PDCryptHandler">PDCryptHandler</a>. It is called when an encrypted document is saved. It fills the document's Encryption dictionary with whatever information the security handler wants to store in the document.<br/>
<p>Normally this callback is called after <a href="pdlayer_PDCrypt.htm#PDCryptUpdateSecurityDataProc" title=" A callback for PDCryptHandler.">PDCryptUpdateSecurityDataProc</a>(). The security data structure can be obtained with a call to <a href="pdlayer_PDDoc.htm#PDDocGetNewSecurityData" title=" Gets the security data structure for the specified document's new security handler.">PDDocGetNewSecurityData</a>(), and <code>encryptDict</code> is filled based on this data.<br/></p>

<p>
<p>The sequencing of events that the viewer performs during creation of the encryptDict is as follows:<br/></p>

<UL><li> The viewer creates the <code>encryptDict</code>.<br/><li> The viewer adds the Filter attribute to the dictionary.<br/><li> The viewer calls this <a href="pdlayer_PDCrypt.htm#PDCryptFillEncryptDictProc" title=" A callback for PDCryptHandler.">PDCryptFillEncryptDictProc</a>() to allow the security handler to add its own attributes to the dictionary.<br/><li> The viewer calls the <a href="pdlayer_PDCrypt.htm#PDCryptNewCryptDataExProc" title=" A callback for PDCryptHandler.">PDCryptNewCryptDataExProc</a>() (the <a href="pdlayer_PDCrypt.htm#PDCryptNewCryptDataProc" title=" A callback for PDCryptHandler.">PDCryptNewCryptDataProc</a>() if unsuccessful) to get the algorithm version, key, and key length.<br/><li> The viewer checks if the V attribute has been added to the dictionary and, if not, it sets V to the algorithm version.<br/><li> The viewer sets the Length attribute if V is <code>2</code> or greater.<br/><li> The viewer adds the encryptDict to the document.<br/></UL>
</div>
</div>

<div class="relatedMethods"><H4><strong>Related Methods</strong></H4>

<span><a href="pdlayer_PDDoc.htm#PDDocSave" title=" Saves a document to disk.">PDDocSave</a> </span>
</div>
</div>

<H4><strong>Syntax</strong></H4>

<code><code>void</code> <code>PDCryptFillEncryptDictProc(</code><a href="pdlayer_PDDoc.htm#PDDoc" title=" The underlying PDF representation of a document."><code>PDDoc</code></a> <code>pdDoc</code><code>,</code> <a href="coslayer_CosObj.htm#CosObj"><code>CosObj</code></a> <code>encryptDict</code><code>);</code> </code>

<H4><strong>Parameters</strong></H4>

<Table class="paramsTable"><tr><td><span><code>pdDoc</code></span>
</td><td><span>IN/OUT The document to save. </span>
</td></tr>
<tr><td><span><code>encryptDict</code></span>
</td><td><span>IN/OUT A dictionary Cos object to fill with whatever information the security handler wants to store in the PDF file. Unlike all other strings and streams, direct object elements of the <code>encryptDict</code> are not encrypted automatically. If you want them encrypted, you must encrypt them before inserting them into the dictionary. </span>
</td></tr></Table>

<H4><strong>Used In</strong></H4>

<nav><table><tr><td><a href="pdlayer_PDCrypt.htm#_t_PDCryptHandler" title=" A data structure containing callbacks that implement a security handler."><code>_t_PDCryptHandler</code></a></td><td><span></span>
</td></tr></table>
</nav>
</section>
<section><div class="infoRow"><h3 id="PDCryptFilterAuthorizeProc"><strong><span style="color:grey;">PDCryptFilterAuthorizeProc</span></strong></h3>

<div class="headerRef"><strong>Header:</strong> PDExpT.h:4935</div>
</div>

<div><div><H4><strong>Description</strong></H4>

<span>(Optional) A callback for <a href="pdlayer_PDCrypt.htm#_t_PDCryptFilterHandler">PDCryptFilterHandler</a>. Acrobat's security mechanism calls this method to determine whether the user should have access to this filter. </span>
</div>

<div class="relatedMethods"><H4><strong>Related Methods</strong></H4>

<a href="pdlayer_PDCrypt.htm#PDCryptAuthorizeFilterAccess" title=" Gets authorization to encrypt or decrypt an embedded file, where that file's cryptographic filter is not the one used to open the document in which the file is embedded."><code>PDCryptAuthorizeFilterAccess</code></a>
<a href="pdlayer_PDCrypt.htm#PDCryptFilterGetDataProc" title=" (Optional) A callback for PDCryptFilterHandler."><code>PDCryptFilterGetDataProc</code></a>
<a href="pdlayer_PDCrypt.htm#PDCryptFilterStreamProc" title=" (Optional) A callback for PDCryptFilterHandler."><code>PDCryptFilterStreamProc</code></a>
<a href="pdlayer_PDCrypt.htm#PDCryptFilterStringProc"><code>PDCryptFilterStringProc</code></a>
<a href="pdlayer_PDDoc.htm#PDDocSetNewCryptFilterMethod" title=" Sets or resets the specified document's security filter method, used for encryption and decryption of the document's data."><code>PDDocSetNewCryptFilterMethod</code></a>
<a href="pdlayer_PDDoc.htm#PDDocSetNewDefaultFilters" title=" Sets or resets the document's default security filter methods for streams and strings, used to encrypt and decrypt the document's data."><code>PDDocSetNewDefaultFilters</code></a></div>
</div>

<H4><strong>Syntax</strong></H4>

<code><a href="aslayer_General.htm#ASBool" title=" ASBool"><code>ASBool</code></a> <code>PDCryptFilterAuthorizeProc(</code><a href="coslayer_CosDoc.htm#CosDoc"><code>CosDoc</code></a> <code>dP</code><code>,</code> <a href="aslayer_ASAtom.htm#ASAtom"><code>ASAtom</code></a> <code>filterName</code><code>,</code> <a href="coslayer_CosObj.htm#CosObj"><code>CosObj</code></a> <code>encryptDict</code><code>,</code> <a href="aslayer_General.htm#ASBool" title=" ASBool"><code>ASBool</code></a> <code>bEncrypt</code><code>,</code> <a href="aslayer_General.htm#ASBool" title=" ASBool"><code>ASBool</code></a> <code>bUIAllowed</code><code>);</code> </code>

<H4><strong>Parameters</strong></H4>

<Table class="paramsTable"><tr><td><span><code>dP</code></span>
</td><td><span>The document for which to perform authorization. </span>
</td></tr>
<tr><td><span><code>filterName</code></span>
</td><td><span>The name of the security filter. </span>
</td></tr>
<tr><td><span><code>encryptDict</code></span>
</td><td><span>The encryption dictionary to use. </span>
</td></tr>
<tr><td><span><code>bEncrypt</code></span>
</td><td><span><a href="aslayer_General.htm#true"><code>true</code></a> if authorization is for an encryption operation, <a href="aslayer_General.htm#false"><code>false</code></a> if it is for a decryption operation. </span>
</td></tr>
<tr><td><span><code>bUIAllowed</code></span>
</td><td><span><a href="aslayer_General.htm#true"><code>true</code></a> if the caller can bring up the security dialogs as needed, <a href="aslayer_General.htm#false"><code>false</code></a> otherwise. </span>
</td></tr></Table>

<H4><strong>Returns</strong></H4>

<span><a href="aslayer_General.htm#true"><code>true</code></a> if the user has access to this filter, <a href="aslayer_General.htm#false"><code>false</code></a> otherwise. </span>

<H4><strong>Used In</strong></H4>

<nav><table><tr><td><a href="pdlayer_PDCrypt.htm#_t_PDCryptFilterHandler" title=" PDCrypt Filter support."><code>_t_PDCryptFilterHandler</code></a></td><td><span></span>
</td></tr></table>
</nav>
</section>
<section><div class="infoRow"><h3 id="PDCryptFilterGetDataProc"><strong><span style="color:grey;">PDCryptFilterGetDataProc</span></strong></h3>

<div class="headerRef"><strong>Header:</strong> PDExpT.h:4957</div>
</div>

<div><div><H4><strong>Description</strong></H4>

<span>(Optional) A callback for <a href="pdlayer_PDCrypt.htm#_t_PDCryptFilterHandler">PDCryptFilterHandler</a>. Acrobat's security mechanism calls this method to retrieve the encryption/decryption key for this filter. It is called only when the filter's encryption method is V2. </span>
</div>

<div class="relatedMethods"><H4><strong>Related Methods</strong></H4>

<a href="pdlayer_PDCrypt.htm#PDCryptFilterAuthorizeProc" title=" (Optional) A callback for PDCryptFilterHandler."><code>PDCryptFilterAuthorizeProc</code></a>
<a href="pdlayer_PDCrypt.htm#PDCryptFilterStreamProc" title=" (Optional) A callback for PDCryptFilterHandler."><code>PDCryptFilterStreamProc</code></a>
<a href="pdlayer_PDCrypt.htm#PDCryptFilterStringProc"><code>PDCryptFilterStringProc</code></a>
<a href="pdlayer_PDDoc.htm#PDDocSetNewCryptFilterData" title=" Sets the encrypted data for the specified document's encryption filter to decrypt."><code>PDDocSetNewCryptFilterData</code></a>
<a href="pdlayer_PDDoc.htm#PDDocSetNewCryptFilterMethod" title=" Sets or resets the specified document's security filter method, used for encryption and decryption of the document's data."><code>PDDocSetNewCryptFilterMethod</code></a>
<a href="pdlayer_PDDoc.htm#PDDocSetNewDefaultFilters" title=" Sets or resets the document's default security filter methods for streams and strings, used to encrypt and decrypt the document's data."><code>PDDocSetNewDefaultFilters</code></a></div>
</div>

<H4><strong>Syntax</strong></H4>

<code><a href="aslayer_General.htm#ASInt32" title=" 4-byte signed long numeric value."><code>ASInt32</code></a> <code>PDCryptFilterGetDataProc(</code><a href="coslayer_CosDoc.htm#CosDoc"><code>CosDoc</code></a> <code>dP</code><code>,</code> <a href="aslayer_ASAtom.htm#ASAtom"><code>ASAtom</code></a> <code>filterName</code><code>,</code> <code>char</code> <code>*</code><code>*</code><code>key</code><code>,</code> <a href="aslayer_General.htm#ASBool" title=" ASBool"><code>ASBool</code></a> <code>bNewKey</code><code>,</code> <a href="aslayer_General.htm#ASBool" title=" ASBool"><code>ASBool</code></a> <code>bUIAllowed</code><code>);</code> </code>

<H4><strong>Parameters</strong></H4>

<Table class="paramsTable"><tr><td><span><code>dP</code></span>
</td><td><span>The document whose data is retrieved. </span>
</td></tr>
<tr><td><span><code>filterName</code></span>
</td><td><span>The name of the security filter. </span>
</td></tr>
<tr><td><span><code>key</code></span>
</td><td><span>(Filled by the method) A pointer to the encryption/decryption key. </span>
</td></tr>
<tr><td><span><code>bNewKey</code></span>
</td><td><span><a href="aslayer_General.htm#true"><code>true</code></a> if you want to retrieve a new key (changed since opening the file), <a href="aslayer_General.htm#false"><code>false</code></a> otherwise. </span>
</td></tr>
<tr><td><span><code>bUIAllowed</code></span>
</td><td><span><a href="aslayer_General.htm#true"><code>true</code></a> if the caller can bring up the security dialogs as needed, <a href="aslayer_General.htm#false"><code>false</code></a> otherwise. </span>
</td></tr></Table>

<H4><strong>Used In</strong></H4>

<nav><table><tr><td><a href="pdlayer_PDCrypt.htm#_t_PDCryptFilterHandler" title=" PDCrypt Filter support."><code>_t_PDCryptFilterHandler</code></a></td><td><span></span>
</td></tr></table>
</nav>
</section>
<section><div class="infoRow"><h3 id="PDCryptFilterStreamProc"><strong><span style="color:grey;">PDCryptFilterStreamProc</span></strong></h3>

<div class="headerRef"><strong>Header:</strong> PDExpT.h:4911</div>
</div>

<div><div><H4><strong>Description</strong></H4>

<div><p>(Optional) A callback for <a href="pdlayer_PDCrypt.htm#_t_PDCryptFilterHandler">PDCryptFilterHandler</a>. Callbacks that conform to this prototype are called to encrypt or decrypt streams from a document.<br/>
<p>The first call to a procedure of this type must fill out an <a href="aslayer_ASCryptStm.htm#_t_ASCryptStmRec" title=" An ASStm object cover used for a cryptographic filter's stream callbacks.">ASCryptStmRec</a> structure with pointers to callback routines for various types of stream access; see <a href="aslayer_ASCryptStm.htm#ASCryptStmProcs" title=" Callback procs for ASCryptStm">ASCryptStmProcs</a>().<br/></p>
</div>
</div>

<div class="relatedMethods"><H4><strong>Related Methods</strong></H4>

<a href="pdlayer_PDCrypt.htm#PDCryptFilterAuthorizeProc" title=" (Optional) A callback for PDCryptFilterHandler."><code>PDCryptFilterAuthorizeProc</code></a>
<a href="pdlayer_PDCrypt.htm#PDCryptFilterGetDataProc" title=" (Optional) A callback for PDCryptFilterHandler."><code>PDCryptFilterGetDataProc</code></a>
<a href="pdlayer_PDCrypt.htm#PDCryptFilterStringProc"><code>PDCryptFilterStringProc</code></a>
<a href="pdlayer_PDDoc.htm#PDDocSetNewCryptFilterData" title=" Sets the encrypted data for the specified document's encryption filter to decrypt."><code>PDDocSetNewCryptFilterData</code></a>
<a href="pdlayer_PDDoc.htm#PDDocSetNewCryptFilterMethod" title=" Sets or resets the specified document's security filter method, used for encryption and decryption of the document's data."><code>PDDocSetNewCryptFilterMethod</code></a>
<a href="pdlayer_PDDoc.htm#PDDocSetNewDefaultFilters" title=" Sets or resets the document's default security filter methods for streams and strings, used to encrypt and decrypt the document's data."><code>PDDocSetNewDefaultFilters</code></a></div>
</div>

<H4><strong>Syntax</strong></H4>

<code><code>void</code> <code>PDCryptFilterStreamProc(</code><a href="coslayer_CosDoc.htm#CosDoc"><code>CosDoc</code></a> <code>dP</code><code>,</code> <a href="aslayer_ASAtom.htm#ASAtom"><code>ASAtom</code></a> <code>filterName</code><code>,</code> <a href="aslayer_ASCryptStm.htm#_t_ASCryptStmRec" title=" An ASStm object cover used for a cryptographic filter's stream callbacks."><code>ASCryptStm</code></a> <code>stm</code><code>,</code> <a href="aslayer_General.htm#ASBool" title=" ASBool"><code>ASBool</code></a> <code>handOff</code><code>,</code> <a href="coslayer_CosObj.htm#CosObj"><code>CosObj</code></a> <code>params</code><code>,</code> <a href="aslayer_General.htm#ASInt32" title=" 4-byte signed long numeric value."><code>ASInt32</code></a> <code>stmLength</code><code>);</code> </code>

<H4><strong>Parameters</strong></H4>

<Table class="paramsTable"><tr><td><span><code>dP</code></span>
</td><td><span>The document containing the stream. </span>
</td></tr>
<tr><td><span><code>filterName</code></span>
</td><td><span>The name of the security filter in use. </span>
</td></tr>
<tr><td><span><code>stm</code></span>
</td><td><span>The security stream structure containing the stream itself, access information, and an <a href="aslayer_ASCryptStm.htm#_t_ASCryptStmRec" title=" An ASStm object cover used for a cryptographic filter's stream callbacks.">ASCryptStmRec</a>. This callback function is called upon opening the stream; the first call must initialize the stream. </span>
</td></tr>
<tr><td><span><code>handOff</code></span>
</td><td><span><a href="aslayer_General.htm#true"><code>true</code></a> if the method should close the base stream when it closes the filter, <a href="aslayer_General.htm#false"><code>false</code></a> otherwise. </span>
</td></tr>
<tr><td><span><code>params</code></span>
</td><td><span>A Cos object containing parameters for the operation, as specified for the filter. </span>
</td></tr>
<tr><td><span><code>stmLength</code></span>
</td><td><span>For a decryption operation, the requested number of bytes; for an encryption operation, the number of bytes in the stream contained in <code>stm</code>. </span>
</td></tr></Table>

<H4><strong>Used In</strong></H4>

<nav><table><tr><td><a href="pdlayer_PDCrypt.htm#_t_PDCryptFilterHandler" title=" PDCrypt Filter support."><code>_t_PDCryptFilterHandler</code></a></td><td><span></span>
</td></tr></table>
</nav>
</section>
<section><div class="infoRow"><h3 id="PDCryptFreeAuthDataProc"><strong><span style="color:grey;">PDCryptFreeAuthDataProc</span></strong></h3>

<div class="headerRef"><strong>Header:</strong> PDExpT.h:4552</div>
</div>

<div><div><H4><strong>Description</strong></H4>

<span>(Optional) A callback for <a href="pdlayer_PDCrypt.htm#_t_PDCryptHandler">PDCryptHandler</a>. It is used to free authorization data acquired via <a href="pdlayer_PDCrypt.htm#PDCryptNewAuthDataProc" title=" (Optional) A callback for PDCryptHandler.">PDCryptNewAuthDataProc</a>(). If this callback is omitted, the viewer defaults to freeing the data using <a href="aslayer_ASMem.htm#ASfree" title=" Frees the specified memory block.">ASfree</a>(). </span>
</div>

<div class="relatedMethods"><H4><strong>Related Methods</strong></H4>

<a href="pdlayer_PDCrypt.htm#PDCryptNewAuthDataProc" title=" (Optional) A callback for PDCryptHandler."><code>PDCryptNewAuthDataProc</code></a>
<a href="pdlayer_PDDoc.htm#PDDocGetNewSecurityInfo" title=" Gets the security information from the specified document's new security handler."><code>PDDocGetNewSecurityInfo</code></a></div>
</div>

<H4><strong>Syntax</strong></H4>

<code><code>void</code> <code>PDCryptFreeAuthDataProc(</code><a href="pdlayer_PDDoc.htm#PDDoc" title=" The underlying PDF representation of a document."><code>PDDoc</code></a> <code>pdDoc</code><code>,</code> <code>void</code> <code>*</code><code>authData</code><code>);</code> </code>

<H4><strong>Parameters</strong></H4>

<Table class="paramsTable"><tr><td><span><code>pdDoc</code></span>
</td><td><span>IN/OUT The document whose authorization data is freed. </span>
</td></tr>
<tr><td><span><code>authData</code></span>
</td><td><span>IN/OUT (Filled by the callback) A pointer to the document's authorization data. </span>
</td></tr></Table>

<H4><strong>Used In</strong></H4>

<nav><table><tr><td><a href="pdlayer_PDCrypt.htm#_t_PDCryptHandler" title=" A data structure containing callbacks that implement a security handler."><code>_t_PDCryptHandler</code></a></td><td><span></span>
</td></tr></table>
</nav>
</section>
<section><div class="infoRow"><h3 id="PDCryptFreeCryptDataProc"><strong><span style="color:grey;">PDCryptFreeCryptDataProc</span></strong></h3>

<div class="headerRef"><strong>Header:</strong> PDExpT.h:4565</div>
</div>

<div><div><H4><strong>Description</strong></H4>

<span>(Optional) A callback for <a href="pdlayer_PDCrypt.htm#_t_PDCryptHandler">PDCryptHandler</a>. It is used to free authorization data acquired via <a href="pdlayer_PDCrypt.htm#PDCryptNewCryptDataProc" title=" A callback for PDCryptHandler.">PDCryptNewCryptDataProc</a>(). If this callback is omitted, the viewer defaults to freeing the data using <a href="aslayer_ASMem.htm#ASfree" title=" Frees the specified memory block.">ASfree</a>(). </span>
</div>

<div class="relatedMethods"><H4><strong>Related Methods</strong></H4>

<a href="pdlayer_PDCrypt.htm#PDCryptNewCryptDataProc" title=" A callback for PDCryptHandler."><code>PDCryptNewCryptDataProc</code></a>
<a href="pdlayer_PDDoc.htm#PDDocGetNewSecurityInfo" title=" Gets the security information from the specified document's new security handler."><code>PDDocGetNewSecurityInfo</code></a></div>
</div>

<H4><strong>Syntax</strong></H4>

<code><code>void</code> <code>PDCryptFreeCryptDataProc(</code><a href="pdlayer_PDDoc.htm#PDDoc" title=" The underlying PDF representation of a document."><code>PDDoc</code></a> <code>pdDoc</code><code>,</code> <code>char</code> <code>*</code><code>cryptData</code><code>);</code> </code>

<H4><strong>Parameters</strong></H4>

<Table class="paramsTable"><tr><td><span><code>pdDoc</code></span>
</td><td><span>IN/OUT The document whose encryption/decryption data is freed. </span>
</td></tr>
<tr><td><span><code>cryptData</code></span>
</td><td><span>IN/OUT (Filled by the callback) A pointer to the document's encryption/decryption data. </span>
</td></tr></Table>

<H4><strong>Used In</strong></H4>

<nav><table><tr><td><a href="pdlayer_PDCrypt.htm#_t_PDCryptHandler" title=" A data structure containing callbacks that implement a security handler."><code>_t_PDCryptHandler</code></a></td><td><span></span>
</td></tr></table>
</nav>
</section>
<section><div class="infoRow"><h3 id="PDCryptFreeSecurityDataProc"><strong><span style="color:grey;">PDCryptFreeSecurityDataProc</span></strong></h3>

<div class="headerRef"><strong>Header:</strong> PDExpT.h:4539</div>
</div>

<div><div><H4><strong>Description</strong></H4>

<span>(Optional) A callback for <a href="pdlayer_PDCrypt.htm#_t_PDCryptHandler">PDCryptHandler</a>. It is used to free security data acquired via <a href="pdlayer_PDCrypt.htm#PDCryptNewSecurityDataProc" title=" (Optional) A callback for PDCryptHandler.">PDCryptNewSecurityDataProc</a>(). If this callback is omitted, the viewer defaults to freeing the data using <a href="aslayer_ASMem.htm#ASfree" title=" Frees the specified memory block.">ASfree</a>(). </span>
</div>

<div class="relatedMethods"><H4><strong>Related Methods</strong></H4>

<a href="pdlayer_PDCrypt.htm#PDCryptNewSecurityDataProc" title=" (Optional) A callback for PDCryptHandler."><code>PDCryptNewSecurityDataProc</code></a>
<a href="pdlayer_PDDoc.htm#PDDocGetNewSecurityInfo" title=" Gets the security information from the specified document's new security handler."><code>PDDocGetNewSecurityInfo</code></a></div>
</div>

<H4><strong>Syntax</strong></H4>

<code><code>void</code> <code>PDCryptFreeSecurityDataProc(</code><a href="pdlayer_PDDoc.htm#PDDoc" title=" The underlying PDF representation of a document."><code>PDDoc</code></a> <code>pdDoc</code><code>,</code> <code>void</code> <code>*</code><code>secData</code><code>);</code> </code>

<H4><strong>Parameters</strong></H4>

<Table class="paramsTable"><tr><td><span><code>pdDoc</code></span>
</td><td><span>IN/OUT The document whose security data is freed. </span>
</td></tr>
<tr><td><span><code>secData</code></span>
</td><td><span>IN/OUT (Filled by the callback) A pointer to the document's security data. </span>
</td></tr></Table>

<H4><strong>Used In</strong></H4>

<nav><table><tr><td><a href="pdlayer_PDCrypt.htm#_t_PDCryptHandler" title=" A data structure containing callbacks that implement a security handler."><code>_t_PDCryptHandler</code></a></td><td><span></span>
</td></tr></table>
</nav>
</section>
<section><div class="infoRow"><h3 id="PDCryptGetAuthDataExProc"><strong><span style="color:grey;">PDCryptGetAuthDataExProc</span></strong></h3>

<div class="headerRef"><strong>Header:</strong> PDExpT.h:4630</div>
</div>

<div><div><H4><strong>Description</strong></H4>

<div><p>Replaces <a href="pdlayer_PDCrypt.htm#PDCryptGetAuthDataProc" title=" A callback for PDCryptHandler.">PDCryptGetAuthDataProc</a>(). It is called whenever Acrobat needs to get authorization data and/or check permissions for operations.<br/>
<p><a href="pdlayer_PDDoc.htm#PDPerms" title=" Constant values that specify permissions which allow operations on a document file.">PDPerms</a> are obsolete. Acrobat provides permission controls, but Acrobat still supports old security handlers.<br/></p>
</div>
</div>

<div class="relatedMethods"><H4><strong>Related Methods</strong></H4>

<span><a href="pdlayer_PDCrypt.htm#PDCryptGetAuthDataProc" title=" A callback for PDCryptHandler.">PDCryptGetAuthDataProc</a> </span>
</div>
</div>

<H4><strong>Syntax</strong></H4>

<code><a href="aslayer_General.htm#ASBool" title=" ASBool"><code>ASBool</code></a> <code>PDCryptGetAuthDataExProc(</code><a href="pdlayer_PDDoc.htm#PDDoc" title=" The underlying PDF representation of a document."><code>PDDoc</code></a> <code>pdDoc</code><code>,</code> <a href="pdlayer_PDDoc.htm#PDPermReqObj" title=" The document object type."><code>PDPermReqObj</code></a> <code>reqObj</code><code>,</code> <a href="pdlayer_PDDoc.htm#PDPermReqOpr" title=" An enumerated data type used to describe the target operation of a permissions request."><code>PDPermReqOpr</code></a> <code>reqOpr</code><code>,</code> <code>void</code> <code>*</code><code>*</code><code>authDataP</code><code>);</code> </code>

<H4><strong>Parameters</strong></H4>

<Table class="paramsTable"><tr><td><span><code>pdDoc</code></span>
</td><td><span>The document for which the request is made. </span>
</td></tr>
<tr><td><span><code>reqObj</code></span>
</td><td><span>The object type that is the focus of the request: it is one of the <a href="pdlayer_PDDoc.htm#PDPermReqObj" title=" The document object type.">PDPermReqObj</a> values. </span>
</td></tr>
<tr><td><span><code>reqOpr</code></span>
</td><td><span>The operation type that is the focus of the request: it is one of the <a href="pdlayer_PDDoc.htm#PDPermReqOpr" title=" An enumerated data type used to describe the target operation of a permissions request.">PDPermReqOpr</a> values. </span>
</td></tr>
<tr><td><span><code>authDataP</code></span>
</td><td><span>A pointer to an authorization data structure. Its format is security handler-specific. </span>
</td></tr></Table>

<H4><strong>Returns</strong></H4>

<span><a href="aslayer_General.htm#true"><code>true</code></a> unless the operation should be cancelled (for example, if the user cancels a dialog), <a href="aslayer_General.htm#false"><code>false</code></a> otherwise. </span>

<H4><strong>Used In</strong></H4>

<nav><table><tr><td><a href="pdlayer_PDCrypt.htm#_t_PDCryptHandler" title=" A data structure containing callbacks that implement a security handler."><code>_t_PDCryptHandler</code></a></td><td><span></span>
</td></tr></table>
</nav>
</section>
<section><div class="infoRow"><h3 id="PDCryptGetAuthDataProc"><strong><span style="color:grey;">PDCryptGetAuthDataProc</span></strong></h3>

<div class="headerRef"><strong>Header:</strong> PDExpT.h:4351</div>
</div>

<div><div><H4><strong>Description</strong></H4>

<div><p>A callback for <a href="pdlayer_PDCrypt.htm#_t_PDCryptHandler">PDCryptHandler</a>. This callback is called from a <a href="pdlayer_PDDoc.htm#PDAuthProc">PDAuthProc</a> when a file is opened after <a href="pdlayer_PDCrypt.htm#PDCryptNewSecurityDataProc" title=" (Optional) A callback for PDCryptHandler.">PDCryptNewSecurityDataProc</a>() is called.<br/>
<p>The callback must determine the user's authorization properties for the document by obtaining authorization data, such as a user interface log in or password entry. It populates an authorization data structure with this data.<br/></p>

<p>
<p>This callback may call the security handler's <a href="pdlayer_PDCrypt.htm#PDCryptNewAuthDataProc" title=" (Optional) A callback for PDCryptHandler.">PDCryptNewAuthDataProc</a>() to allocate the authorization data structure. The use of an authorization data structure is optional (an implementation may wish to contain authorization data within the security data structure). The authorization data structure is subsequently used by the security handler's <a href="pdlayer_PDCrypt.htm#PDCryptAuthorizeProc" title=" A callback for PDCryptHandler.">PDCryptAuthorizeProc</a>() to determine whether the user is authorized to open the file.<br/></p>

<p>
<p>A security handler can specify the standard password dialog box by using AVCryptGetPassword(). In this case, <code>authData</code> is a <code>char</code> <code>*</code>.<br/></p>
</div>
</div>

<div class="relatedMethods"><H4><strong>Related Methods</strong></H4>

<a href="pdlayer_PDCrypt.htm#PDCryptGetAuthDataExProc" title=" Replaces PDCryptGetAuthDataProc()."><code>PDCryptGetAuthDataExProc</code></a>
<a href="pdlayer_PDCrypt.htm#PDCryptNewAuthDataProc" title=" (Optional) A callback for PDCryptHandler."><code>PDCryptNewAuthDataProc</code></a>
<a href="pdlayer_PDDoc.htm#PDDocOpen" title=" Opens the specified document."><code>PDDocOpen</code></a>
<a href="pdlayer_PDDoc.htm#PDDocOpen" title=" Opens the specified document."><code>PDDocOpen</code></a>
<a href="pdlayer_PDDoc.htm#PDDocOpenEx" title=" Opens the specified document."><code>PDDocOpenEx</code></a></div>
</div>

<H4><strong>Syntax</strong></H4>

<code><a href="aslayer_General.htm#ASBool" title=" ASBool"><code>ASBool</code></a> <code>PDCryptGetAuthDataProc(</code><a href="pdlayer_PDDoc.htm#PDDoc" title=" The underlying PDF representation of a document."><code>PDDoc</code></a> <code>pdDoc</code><code>,</code> <a href="pdlayer_PDDoc.htm#PDPerms" title=" Constant values that specify permissions which allow operations on a document file."><code>PDPerms</code></a> <code>permWanted</code><code>,</code> <code>void</code> <code>*</code><code>*</code><code>authDataP</code><code>);</code> </code>

<H4><strong>Parameters</strong></H4>

<Table class="paramsTable"><tr><td><span><code>pdDoc</code></span>
</td><td><span>The document to open. </span>
</td></tr>
<tr><td><span><code>permWanted</code></span>
</td><td><span>Either <a href="pdlayer_PDDoc.htm#pdPermOpen" title=" The user can open and decrypt the document."><code>pdPermOpen</code></a> or <a href="pdlayer_PDDoc.htm#pdPermSecure" title=" The user can change the document's security settings."><code>pdPermSecure</code></a>. Since this value is also passed to <a href="pdlayer_PDCrypt.htm#PDCryptAuthorizeProc" title=" A callback for PDCryptHandler.">PDCryptAuthorizeProc</a>(), it may not be necessary for this callback to use <code>permWanted</code>. </span>
</td></tr>
<tr><td><span><code>authDataP</code></span>
</td><td><span>A pointer to the authorization data structure. Set it to <a href="aslayer_General.htm#NULL"><code>NULL</code></a> if it is not used. </span>
</td></tr></Table>

<H4><strong>Returns</strong></H4>

<span><a href="aslayer_General.htm#true"><code>true</code></a> unless the operation should be cancelled (for example, if the user cancels a dialog), <a href="aslayer_General.htm#false"><code>false</code></a> otherwise. </span>

<H4><strong>Used In</strong></H4>

<nav><table><tr><td><a href="pdlayer_PDCrypt.htm#_t_PDCryptHandler" title=" A data structure containing callbacks that implement a security handler."><code>_t_PDCryptHandler</code></a></td><td><span></span>
</td></tr></table>
</nav>
</section>
<section><div class="infoRow"><h3 id="PDCryptGetDocPermsProc"><strong><span style="color:grey;">PDCryptGetDocPermsProc</span></strong></h3>

<div class="headerRef"><strong>Header:</strong> PDExpT.h:4718</div>
</div>

<div><div><H4><strong>Description</strong></H4>

<div><p>A callback for <a href="pdlayer_PDCrypt.htm#_t_PDCryptHandler">PDCryptHandler</a>. This function should extract and return information about the document permissions to display for the user: whether the user can print, edit, copy text and graphics, edit notes and do form fill in and signing.<br/>
<p>The permissions returned are logically AND-ed with the document permissions returned by any other permissions handlers, and displayed to the user. All crypt handlers should implement this call so that consolidated permissions can be displayed. To display your own crypt handler's permissions, implement <a href="pdlayer_PDCrypt.htm#PDCryptDisplaySecurityDataProc" title=" Called when the security handler should bring up a document (security) information dialog box with the current settings.">PDCryptDisplaySecurityDataProc</a>().<br/></p>

<p>
<p>If this callback is absent, Acrobat assumes that all the operations on the document are allowed.<br/></p>
</div>
</div>

<div class="relatedMethods"><H4><strong>Related Methods</strong></H4>

<span><a href="pdlayer_PDDoc.htm#PDDocPermRequest" title=" This method supersedes PDDocGetPermissions().">PDDocPermRequest</a> </span>
</div>
</div>

<H4><strong>Syntax</strong></H4>

<code><code>void</code> <code>PDCryptGetDocPermsProc(</code><a href="pdlayer_PDDoc.htm#PDDoc" title=" The underlying PDF representation of a document."><code>PDDoc</code></a> <code>pdDoc</code><code>,</code> <a href="aslayer_General.htm#ASBool" title=" ASBool"><code>ASBool</code></a> <code>perms</code> <code>[</code><a href="pdlayer_PDDoc.htm#PDPermReqObjLast" title=" Used for checking cache size."><code>PDPermReqObjLast</code></a><code>]</code> <code>[</code><a href="pdlayer_PDDoc.htm#PDPermReqOprLast" title=" This should be always the last item"><code>PDPermReqOprLast</code></a><code>]</code><code>,</code> <a href="aslayer_General.htm#ASInt16" title=" 2-byte signed short numeric value."><code>ASInt16</code></a> <code>*</code><code>version</code><code>);</code> </code>

<H4><strong>Parameters</strong></H4>

<Table class="paramsTable"><tr><td><span><code>pdDoc</code></span>
</td><td><span>The document whose permissions are obtained. </span>
</td></tr>
<tr><td><span><code>perms</code></span>
</td><td><span>(Filled by the callback) An array of the document's permissions. For each combination of <a href="pdlayer_PDDoc.htm#PDPermReqObj" title=" The document object type.">PDPermReqObj</a> and <a href="pdlayer_PDDoc.htm#PDPermReqOpr" title=" An enumerated data type used to describe the target operation of a permissions request.">PDPermReqOpr</a>, the value is <a href="aslayer_General.htm#true"><code>true</code></a> if the operation is allowed for the object, <a href="aslayer_General.htm#false"><code>false</code></a> if it is not. </span>
</td></tr>
<tr><td><span><code>version</code></span>
</td><td><span>(Filled by the callback) A pointer to the version number of <a href="pdlayer_PDDoc.htm#PDPermReqObj" title=" The document object type.">PDPermReqObj</a> and <a href="pdlayer_PDDoc.htm#PDPermReqOpr" title=" An enumerated data type used to describe the target operation of a permissions request.">PDPermReqOpr</a> with which this crypt handler is compatible (specified by the constant <a href="pdlayer_PDDoc.htm#PDPermReqVersion">PDPermReqVersion</a>). </span>
</td></tr></Table>

<H4><strong>Used In</strong></H4>

<nav><table><tr><td><a href="pdlayer_PDCrypt.htm#_t_PDCryptHandler" title=" A data structure containing callbacks that implement a security handler."><code>_t_PDCryptHandler</code></a></td><td><span></span>
</td></tr></table>
</nav>
</section>
<section><div class="infoRow"><h3 id="PDCryptGetInfoTextProc"><strong><span style="color:grey;">PDCryptGetInfoTextProc</span></strong></h3>

<div class="headerRef"><strong>Header:</strong> PDExpT.h:4751</div>
</div>

<div><H4><strong>Description</strong></H4>

<span>(Optional) A callback for <a href="pdlayer_PDCrypt.htm#_t_PDCryptHandler">PDCryptHandler</a>. It provides information for display about document security settings. </span>
</div>

<H4><strong>Syntax</strong></H4>

<code><a href="aslayer_ASText.htm#ASText" title=" An opaque object holding encoded text."><code>ASText</code></a> <code>PDCryptGetInfoTextProc(</code><a href="pdlayer_PDDoc.htm#PDDoc" title=" The underlying PDF representation of a document."><code>PDDoc</code></a> <code>pdDoc</code><code>,</code> <a href="pdlayer_PDCrypt.htm#GCHTextType"><code>GCHTextType</code></a> <code>textType</code><code>);</code> </code>

<H4><strong>Parameters</strong></H4>

<Table class="paramsTable"><tr><td><span><code>pdDoc</code></span>
</td><td><span><a href="pdslayer_General.htm#IN">IN</a> The document. </span>
</td></tr>
<tr><td><span><code>textType</code></span>
</td><td><div><span><a href="pdslayer_General.htm#IN">IN</a> The text that should be used: </span>

<table class="ruled"><tr><th><span>Value</span>
</th><th><span>Description</span>
</th></tr>
<tr><td><span><a href="pdlayer_PDCrypt.htm#kGCHTTipText"><code>kGCHTTipText</code></a></span>
</td><td><span>Text used for a security tool tip. It should be short. Its default is <code>"This</code> <code>document</code> <code>is</code> <code>secured."</code></span>
</td></tr>
<tr><td><span><a href="pdlayer_PDCrypt.htm#kGCHTMiniText"><code>kGCHTMiniText</code></a></span>
</td><td><span>Text used for a security hover. It should be medium length. Its default is <code>"This</code> <code>document</code> <code>has</code> <code>been</code> <code>encrypted</code> <code>and</code> <code>may</code> <code>use..."</code></span>
</td></tr>
<tr><td><span><a href="pdlayer_PDCrypt.htm#kGCHTLargeText"><code>kGCHTLargeText</code></a></span>
</td><td><span>Text use for Toast on Windows. It can have a longer length. There is no default.</span>
</td></tr></table>
</div>
</td></tr></Table>

<H4><strong>Returns</strong></H4>

<span>The <a href="aslayer_ASText.htm#ASText" title=" An opaque object holding encoded text.">ASText</a> value owned by the caller. Use a default value of <a href="aslayer_General.htm#NULL"><code>NULL</code></a>. </span>

<H4><strong>Used In</strong></H4>

<nav><table><tr><td><a href="pdlayer_PDCrypt.htm#_t_PDCryptHandler" title=" A data structure containing callbacks that implement a security handler."><code>_t_PDCryptHandler</code></a></td><td><span></span>
</td></tr></table>
</nav>
</section>
<section><div class="infoRow"><h3 id="PDCryptGetSecurityInfoProc"><strong><span style="color:grey;">PDCryptGetSecurityInfoProc</span></strong></h3>

<div class="headerRef"><strong>Header:</strong> PDExpT.h:4526</div>
</div>

<div><div><H4><strong>Description</strong></H4>

<div><p>(Optional) A callback for <a href="pdlayer_PDCrypt.htm#_t_PDCryptHandler">PDCryptHandler</a>. It is called by <a href="pdlayer_PDDoc.htm#PDDocGetNewSecurityInfo" title=" Gets the security information from the specified document's new security handler.">PDDocGetNewSecurityInfo</a>(). It extracts the security information from the security data structure, and returns the security information.<br/>
<p>This function is also used after a Save As... to reset the permissions according to the current document.<br/></p>

<p>
<p>A default set of permissions is used if this callback is absent:<br/></p>

<p>
<p><code>pdInfoCanPrint|pdInfoCanEdit|pdInfoCanCopy|pdInfoCanEditNotes</code><br/></p>

<p>
<p>See <a href="pdlayer_PDDoc.htm#PDPerms" title=" Constant values that specify permissions which allow operations on a document file.">PDPerms</a>.<br/></p>
</div>
</div>

<div class="relatedMethods"><H4><strong>Related Methods</strong></H4>

<span><a href="pdlayer_PDDoc.htm#PDDocGetNewSecurityInfo" title=" Gets the security information from the specified document's new security handler.">PDDocGetNewSecurityInfo</a> </span>
</div>
</div>

<H4><strong>Syntax</strong></H4>

<code><code>void</code> <code>PDCryptGetSecurityInfoProc(</code><a href="pdlayer_PDDoc.htm#PDDoc" title=" The underlying PDF representation of a document."><code>PDDoc</code></a> <code>pdDoc</code><code>,</code> <a href="aslayer_General.htm#ASUns32" title=" 4-byte unsigned long numeric value."><code>ASUns32</code></a> <code>*</code><code>secInfo</code><code>);</code> </code>

<H4><strong>Parameters</strong></H4>

<Table class="paramsTable"><tr><td><span><code>pdDoc</code></span>
</td><td><span>The document whose security information is obtained. </span>
</td></tr>
<tr><td><span><code>secInfo</code></span>
</td><td><span>(Filled by the callback) The document's security information. The value must be an OR of the Security Info Flags. All unused bits in must be set to <code>1</code>. </span>
</td></tr></Table>

<H4><strong>Used In</strong></H4>

<nav><table><tr><td><a href="pdlayer_PDCrypt.htm#_t_PDCryptHandler" title=" A data structure containing callbacks that implement a security handler."><code>_t_PDCryptHandler</code></a></td><td><span></span>
</td></tr></table>
</nav>
</section>
<section><div class="infoRow"><h3 id="PDCryptNewAuthDataProc"><strong><span style="color:grey;">PDCryptNewAuthDataProc</span></strong></h3>

<div class="headerRef"><strong>Header:</strong> PDExpT.h:4315</div>
</div>

<div><div><H4><strong>Description</strong></H4>

<div><p>(Optional) A callback for <a href="pdlayer_PDCrypt.htm#_t_PDCryptHandler">PDCryptHandler</a>. It creates a new empty authorization data structure. This structure is subsequently filled by <a href="pdlayer_PDCrypt.htm#PDCryptGetAuthDataProc" title=" A callback for PDCryptHandler.">PDCryptGetAuthDataProc</a>(), then passed to <a href="pdlayer_PDCrypt.htm#PDCryptAuthorizeProc" title=" A callback for PDCryptHandler.">PDCryptAuthorizeProc</a>() and eventually to <a href="aslayer_ASMem.htm#ASfree" title=" Frees the specified memory block.">ASfree</a>().<br/>
<p>This callback is not called by the Acrobat viewer, but a security handler may use it if it wishes. The Acrobat viewer's standard security handler does not use this method.<br/></p>
</div>
</div>

<div class="relatedMethods"><H4><strong>Related Methods</strong></H4>

<a href="pdlayer_PDCrypt.htm#PDCryptFreeAuthDataProc" title=" (Optional) A callback for PDCryptHandler."><code>PDCryptFreeAuthDataProc</code></a>
<a href="pdlayer_PDCrypt.htm#PDCryptGetAuthDataProc" title=" A callback for PDCryptHandler."><code>PDCryptGetAuthDataProc</code></a></div>
</div>

<H4><strong>Syntax</strong></H4>

<code><code>void</code> <code>*</code><code>PDCryptNewAuthDataProc(</code><a href="pdlayer_PDDoc.htm#PDDoc" title=" The underlying PDF representation of a document."><code>PDDoc</code></a> <code>pdDoc</code><code>);</code> </code>

<H4><strong>Parameters</strong></H4>

<Table class="paramsTable"><tr><td><span><code>pdDoc</code></span>
</td><td><span>The document for which a new authorization data structure is created. </span>
</td></tr></Table>

<H4><strong>Returns</strong></H4>

<span>The newly created authorization data structure. </span>

<H4><strong>Used In</strong></H4>

<nav><table><tr><td><a href="pdlayer_PDCrypt.htm#_t_PDCryptHandler" title=" A data structure containing callbacks that implement a security handler."><code>_t_PDCryptHandler</code></a></td><td><span></span>
</td></tr></table>
</nav>
</section>
<section><div class="infoRow"><h3 id="PDCryptNewCryptDataExProc"><strong><span style="color:grey;">PDCryptNewCryptDataExProc</span></strong></h3>

<div class="headerRef"><strong>Header:</strong> PDExpT.h:4587</div>
</div>

<div><div><H4><strong>Description</strong></H4>

<div><p>A callback for <a href="pdlayer_PDCrypt.htm#_t_PDCryptHandler">PDCryptHandler</a>. It sets up the key to be passed to initialize the RC4 cipher for encryption and decryption of a PDF file. It is called when an encrypted document is opened or saved.<br/>
<p>The key is truncated when the length is greater than the viewer currently supports. Data is freed by <a href="pdlayer_PDCrypt.htm#PDCryptFreeCryptDataProc" title=" (Optional) A callback for PDCryptHandler.">PDCryptFreeCryptDataProc</a>() if provided. Otherwise, <a href="aslayer_ASMem.htm#ASfree" title=" Frees the specified memory block.">ASfree</a>() is used.<br/></p>
</div>
</div>

<div class="relatedMethods"><H4><strong>Related Methods</strong></H4>

<span><a href="pdlayer_PDCrypt.htm#PDCryptFreeCryptDataProc" title=" (Optional) A callback for PDCryptHandler.">PDCryptFreeCryptDataProc</a> </span>
</div>
</div>

<H4><strong>Syntax</strong></H4>

<code><code>void</code> <code>PDCryptNewCryptDataExProc(</code><a href="pdlayer_PDDoc.htm#PDDoc" title=" The underlying PDF representation of a document."><code>PDDoc</code></a> <code>pdDoc</code><code>,</code> <code>char</code> <code>*</code><code>*</code><code>cryptData</code><code>,</code> <a href="aslayer_General.htm#ASInt32" title=" 4-byte signed long numeric value."><code>ASInt32</code></a> <code>*</code><code>cryptDataLen</code><code>,</code> <a href="aslayer_General.htm#ASInt32" title=" 4-byte signed long numeric value."><code>ASInt32</code></a> <code>*</code><code>cryptVersion</code><code>);</code> </code>

<H4><strong>Parameters</strong></H4>

<Table class="paramsTable"><tr><td><span><code>pdDoc</code></span>
</td><td><span>IN/OUT The document for which the key is set. </span>
</td></tr>
<tr><td><span><code>cryptData</code></span>
</td><td><span>IN/OUT (Filled by the callback) The key. <code>cryptData</code> must be allocated by <a href="aslayer_ASMem.htm#ASmalloc" title=" Allocates and returns a pointer to a memory block containing the specified number of bytes.">ASmalloc</a>() because the Acrobat viewer will free it using <a href="aslayer_ASMem.htm#ASfree" title=" Frees the specified memory block.">ASfree</a>(). </span>
</td></tr>
<tr><td><span><code>cryptDataLen</code></span>
</td><td><span>IN/OUT (Filled by the callback) The number of bytes in <code>cryptData</code>. It cannot be greater than <code>5</code> bytes. </span>
</td></tr>
<tr><td><span><code>cryptVersion</code></span>
</td><td><span>IN/OUT The Cos crypt version, which is the version of the algorithm that is used to encrypt and decrypt document data. <code>cryptVersion</code> equal to <code>0</code> is treated as <code>cryptVersion</code> equal to <code>1</code> to maintain backward compatibility. </span>
</td></tr></Table>

<H4><strong>Used In</strong></H4>

<nav><table><tr><td><a href="pdlayer_PDCrypt.htm#_t_PDCryptHandler" title=" A data structure containing callbacks that implement a security handler."><code>_t_PDCryptHandler</code></a></td><td><span></span>
</td></tr></table>
</nav>
</section>
<section><div class="infoRow"><h3 id="PDCryptNewCryptDataProc"><strong><span style="color:grey;">PDCryptNewCryptDataProc</span></strong></h3>

<div class="headerRef"><strong>Header:</strong> PDExpT.h:4467</div>
</div>

<div><div><H4><strong>Description</strong></H4>

<span>A callback for <a href="pdlayer_PDCrypt.htm#_t_PDCryptHandler">PDCryptHandler</a>. It sets up the key to be passed to initialize the RC4 cipher for encryption and decryption of a PDF file. It is called when an encrypted document is opened or saved. </span>
</div>

<div class="relatedMethods"><H4><strong>Related Methods</strong></H4>

<span><a href="pdlayer_PDCrypt.htm#PDCryptNewAuthDataProc" title=" (Optional) A callback for PDCryptHandler.">PDCryptNewAuthDataProc</a> </span>
</div>
</div>

<H4><strong>Syntax</strong></H4>

<code><code>void</code> <code>PDCryptNewCryptDataProc(</code><a href="pdlayer_PDDoc.htm#PDDoc" title=" The underlying PDF representation of a document."><code>PDDoc</code></a> <code>pdDoc</code><code>,</code> <code>char</code> <code>*</code><code>*</code><code>cryptData</code><code>,</code> <a href="aslayer_General.htm#ASInt32" title=" 4-byte signed long numeric value."><code>ASInt32</code></a> <code>*</code><code>cryptDataLen</code><code>);</code> </code>

<H4><strong>Parameters</strong></H4>

<Table class="paramsTable"><tr><td><span><code>pdDoc</code></span>
</td><td><span>IN/OUT The document for which the key is set. </span>
</td></tr>
<tr><td><span><code>cryptData</code></span>
</td><td><span>IN/OUT (Filled by the callback) The key. <code>cryptData</code> must be allocated by <a href="aslayer_ASMem.htm#ASmalloc" title=" Allocates and returns a pointer to a memory block containing the specified number of bytes.">ASmalloc</a>() because the Acrobat viewer will free it using <a href="aslayer_ASMem.htm#ASfree" title=" Frees the specified memory block.">ASfree</a>(). </span>
</td></tr>
<tr><td><span><code>cryptDataLen</code></span>
</td><td><span>IN/OUT (Filled by the callback) The number of bytes in cryptData. It cannot be greater than <code>5</code> bytes. </span>
</td></tr></Table>

<H4><strong>Used In</strong></H4>

<nav><table><tr><td><a href="pdlayer_PDCrypt.htm#_t_PDCryptHandler" title=" A data structure containing callbacks that implement a security handler."><code>_t_PDCryptHandler</code></a></td><td><span></span>
</td></tr></table>
</nav>
</section>
<section><div class="infoRow"><h3 id="PDCryptNewSecurityDataFromOriginalDocProc"><strong><span style="color:grey;">PDCryptNewSecurityDataFromOriginalDocProc</span></strong></h3>

<div class="headerRef"><strong>Header:</strong> PDExpT.h:4657</div>
</div>

<div><H4><strong>Description</strong></H4>

<div><p>Called when the application needs to open a rolled back portion of the original document. A <em>rolled</em> <em>back</em> document is the original portion of the document when it is digitally signed. This functionality is used for document modification detection.<br/>
<p>A rolled back document still requires authorization data which should be identical to the original document's. However, the <code>authDataP</code> structure is unique to each security handler; therefore, it cannot be duplicated by the application.<br/></p>

<p>
<p>This callback is intended for opening a rolled back document silently by asking the security handler to provide authorization data for it. The security handler should be able to duplicate the security data associated with the original document and supply for the rolled back document. The callee is expected to authorize subsequent callbacks, including Crypt Filters.<br/></p>

<p>
<p>If this callback is not provided, the security handler is asked for authorization data via a normal call such as <a href="pdlayer_PDCrypt.htm#PDCryptGetAuthDataExProc" title=" Replaces PDCryptGetAuthDataProc().">PDCryptGetAuthDataExProc</a>(). The side effect might include the security handler's prompting for a password for the rolled back document.<br/></p>
</div>
</div>

<H4><strong>Syntax</strong></H4>

<code><a href="aslayer_General.htm#ASBool" title=" ASBool"><code>ASBool</code></a> <code>PDCryptNewSecurityDataFromOriginalDocProc(</code><a href="pdlayer_PDDoc.htm#PDDoc" title=" The underlying PDF representation of a document."><code>PDDoc</code></a> <code>pdDoc</code><code>,</code> <a href="coslayer_CosObj.htm#CosObj"><code>CosObj</code></a> <code>encryptDict</code><code>,</code> <a href="pdlayer_PDDoc.htm#PDDoc" title=" The underlying PDF representation of a document."><code>PDDoc</code></a> <code>alreadyOpenedDoc</code><code>,</code> <a href="coslayer_CosObj.htm#CosObj"><code>CosObj</code></a> <code>openedEncryptDict</code><code>,</code> <code>void</code> <code>*</code><code>*</code><code>authDataP</code><code>);</code> </code>

<H4><strong>Parameters</strong></H4>

<Table class="paramsTable"><tr><td><span><code>pdDoc</code></span>
</td><td><span>The document for which the request is made (a rolled back document). </span>
</td></tr>
<tr><td><span><code>encryptDict</code></span>
</td><td><span>An encryption dictionary for <code>pdDoc</code>. It is here just in case the security handler might need it. </span>
</td></tr>
<tr><td><span><code>alreadyOpenedDoc</code></span>
</td><td><span>The original <a href="pdlayer_PDDoc.htm#PDDoc" title=" The underlying PDF representation of a document.">PDDoc</a> from which the rolled back document is extracted. It is provided so that the security handler can get security data out for the rolled back document. </span>
</td></tr>
<tr><td><span><code>openedEncryptDict</code></span>
</td><td><span>The encryption dictionary of the original <a href="pdlayer_PDDoc.htm#PDDoc" title=" The underlying PDF representation of a document.">PDDoc</a>. </span>
</td></tr>
<tr><td><span><code>authDataP</code></span>
</td><td><span>Used to return security data for the rolled back document. </span>
</td></tr></Table>

<H4><strong>Returns</strong></H4>

<span><a href="aslayer_General.htm#true"><code>true</code></a> unless the security handler cannot provide authorization data for the requested document. </span>

<H4><strong>Used In</strong></H4>

<nav><table><tr><td><a href="pdlayer_PDCrypt.htm#_t_PDCryptHandler" title=" A data structure containing callbacks that implement a security handler."><code>_t_PDCryptHandler</code></a></td><td><span></span>
</td></tr></table>
</nav>
</section>
<section><div class="infoRow"><h3 id="PDCryptNewSecurityDataProc"><strong><span style="color:grey;">PDCryptNewSecurityDataProc</span></strong></h3>

<div class="headerRef"><strong>Header:</strong> PDExpT.h:4393</div>
</div>

<div><div><H4><strong>Description</strong></H4>

<div><p>(Optional) A callback for <a href="pdlayer_PDCrypt.htm#_t_PDCryptHandler">PDCryptHandler</a>. It creates and populates a new structure that contains whatever security-related information the security handler requires (for example, permissions, whether the file has owner and/or user passwords, owner and/or user passwords, or other data used internally by the security handler). If <code>encryptDict</code> is not <a href="aslayer_General.htm#NULL"><code>NULL</code></a>, the structure should be populated based on the <code>encryptDict</code> parameter's contents. This method is intended only to initialize the security data structure.<br/>
<p>This callback is called under two circumstances:<br/></p>

<UL><li> When a document is opened, it is called with encryptDict set to the document's Encryption dictionary. The handler should then populate the new security data structure with data that is obtained from the Encryption dictionary.<br/><li> When the user chooses a new encryption method, it is called without an encryptDict. The handler should return a security data structure with default values.<br/></UL>

<p>
<p>If a security handler does not have this callback, the document's <code>newSecurityData</code> field is set to <a href="aslayer_General.htm#NULL"><code>NULL</code></a>.<br/></p>

<p>
<p>If a file is to be saved, then <a href="pdlayer_PDCrypt.htm#PDCryptUpdateSecurityDataProc" title=" A callback for PDCryptHandler.">PDCryptUpdateSecurityDataProc</a>() is subsequently called to allow user interface modification of the contents.<br/></p>

<p>
<p>Security data is freed using <a href="pdlayer_PDCrypt.htm#PDCryptFreeSecurityDataProc" title=" (Optional) A callback for PDCryptHandler.">PDCryptFreeSecurityDataProc</a>(). If <a href="pdlayer_PDCrypt.htm#PDCryptFreeSecurityDataProc" title=" (Optional) A callback for PDCryptHandler.">PDCryptFreeSecurityDataProc</a>() is not defined, <a href="aslayer_ASMem.htm#ASfree" title=" Frees the specified memory block.">ASfree</a>() is used.<br/></p>
</div>
</div>

<div class="relatedMethods"><H4><strong>Related Methods</strong></H4>

<span><a href="pdlayer_PDCrypt.htm#PDCryptFreeSecurityDataProc" title=" (Optional) A callback for PDCryptHandler.">PDCryptFreeSecurityDataProc</a> </span>
</div>
</div>

<H4><strong>Syntax</strong></H4>

<code><code>void</code> <code>*</code><code>PDCryptNewSecurityDataProc(</code><a href="pdlayer_PDDoc.htm#PDDoc" title=" The underlying PDF representation of a document."><code>PDDoc</code></a> <code>pdDoc</code><code>,</code> <a href="coslayer_CosObj.htm#CosObj"><code>CosObj</code></a> <code>encryptDict</code><code>);</code> </code>

<H4><strong>Parameters</strong></H4>

<Table class="paramsTable"><tr><td><span><code>pdDoc</code></span>
</td><td><span>The document for which a new security data structure is created. </span>
</td></tr>
<tr><td><span><code>encryptDict</code></span>
</td><td><span>If <code>encryptDict</code> is a dictionary, this callback must initialize the security data so that it corresponds to the dictionary. Otherwise, it must set up default values in the security data structure. </span>
</td></tr></Table>

<H4><strong>Returns</strong></H4>

<span>The newly created security data structure. </span>

<H4><strong>Used In</strong></H4>

<nav><table><tr><td><a href="pdlayer_PDCrypt.htm#_t_PDCryptHandler" title=" A data structure containing callbacks that implement a security handler."><code>_t_PDCryptHandler</code></a></td><td><span></span>
</td></tr></table>
</nav>
</section>
<section><div class="infoRow"><h3 id="PDCryptReservedProc"><strong><span style="color:grey;">PDCryptReservedProc</span></strong></h3>

<div class="headerRef"><strong>Header:</strong> PDExpT.h:4677</div>
</div>

<div><H4><strong>Description</strong></H4>

<span>(Optional) A callback for <a href="pdlayer_PDCrypt.htm#_t_PDCryptHandler">PDCryptHandler</a>. It is used by the Acrobat WebBuy proprietary method of passing crypt data. </span>
</div>

<H4><strong>Syntax</strong></H4>

<code><code>void</code> <code>*</code><code>PDCryptReservedProc(</code><code>void</code><code>);</code> </code>

<H4><strong>Used In</strong></H4>

<nav><table><tr><td><a href="pdlayer_PDCrypt.htm#_t_PDCryptHandler" title=" A data structure containing callbacks that implement a security handler."><code>_t_PDCryptHandler</code></a></td><td><span></span>
</td></tr></table>
</nav>
</section>
<section><div class="infoRow"><h3 id="PDCryptReservedProc2"><strong><span style="color:grey;">PDCryptReservedProc2</span></strong></h3>

<div class="headerRef"><strong>Header:</strong> PDExpT.h:4755</div>
</div>

<div><H4><strong>Description</strong></H4>

<span>(Optional) Used by Acrobat for Automated Permission Testing. </span>
</div>

<H4><strong>Syntax</strong></H4>

<code><code>void</code> <code>*</code><code>PDCryptReservedProc2(</code><a href="pdlayer_PDDoc.htm#PDDoc" title=" The underlying PDF representation of a document."><code>PDDoc</code></a> <code>pdDoc</code><code>,</code> <a href="aslayer_ASCab.htm#ASCab" title=" ASCab objects ( cabinets ) can be used to store arbitrary key/value pairs."><code>ASCab</code></a> <code>settings</code><code>);</code> </code>

<H4><strong>Used In</strong></H4>

<nav><table><tr><td><a href="pdlayer_PDCrypt.htm#_t_PDCryptHandler" title=" A data structure containing callbacks that implement a security handler."><code>_t_PDCryptHandler</code></a></td><td><span></span>
</td></tr></table>
</nav>
</section>
<section><div class="infoRow"><h3 id="PDCryptUpdateSecurityDataProc"><strong><span style="color:grey;">PDCryptUpdateSecurityDataProc</span></strong></h3>

<div class="headerRef"><strong>Header:</strong> PDExpT.h:4452</div>
</div>

<div><div><H4><strong>Description</strong></H4>

<div><p>A callback for <a href="pdlayer_PDCrypt.htm#_t_PDCryptHandler">PDCryptHandler</a>. It updates the security data structure that was created by <a href="pdlayer_PDCrypt.htm#PDCryptNewSecurityDataProc" title=" (Optional) A callback for PDCryptHandler.">PDCryptNewSecurityDataProc</a>(). This structure can be obtained by calling <a href="pdlayer_PDDoc.htm#PDDocGetNewSecurityData" title=" Gets the security data structure for the specified document's new security handler.">PDDocGetNewSecurityData</a>(). The security data structure of the previously saved file can be obtained with a call to <a href="pdlayer_PDDoc.htm#PDDocGetSecurityData" title=" Superseded in Acrobat 5.0 by PDDocPermRequest.">PDDocGetSecurityData</a>().<br/>
<p>The security data structure should be updated to reflect the encryption parameters that will be used when saving the file (this information is usually obtained via dialogs). The encryption parameters are transferred to the Encrypt dictionary by a subsequent callback to <a href="pdlayer_PDCrypt.htm#PDCryptFillEncryptDictProc" title=" A callback for PDCryptHandler.">PDCryptFillEncryptDictProc</a>().<br/></p>

<p>
<p>The security data should be allocated by <a href="aslayer_ASMem.htm#ASmalloc" title=" Allocates and returns a pointer to a memory block containing the specified number of bytes.">ASmalloc</a>() or a related function. Security data is freed using <a href="pdlayer_PDCrypt.htm#PDCryptFreeSecurityDataProc" title=" (Optional) A callback for PDCryptHandler.">PDCryptFreeSecurityDataProc</a>(). If <a href="pdlayer_PDCrypt.htm#PDCryptFreeSecurityDataProc" title=" (Optional) A callback for PDCryptHandler.">PDCryptFreeSecurityDataProc</a>() is not defined, <a href="aslayer_ASMem.htm#ASfree" title=" Frees the specified memory block.">ASfree</a>() is used.<br/></p>

<p>
<p>The callback can also update the security handler itself. For example, the standard encryption handler switches to no encryption if no passwords or permissions are set in the security dialog box. Return <a href="aslayer_ASAtom.htm#ASAtomNull">ASAtomNull</a> in <code>cryptHandler</code> if no encryption is used in the saved file.<br/></p>
</div>
</div>

<div class="relatedMethods"><H4><strong>Related Methods</strong></H4>

<a href="pdlayer_PDCrypt.htm#PDCryptValidateSecurityDataProc" title=" (Optional) A callback for PDCryptHandler."><code>PDCryptValidateSecurityDataProc</code></a>
<a href="pdlayer_PDDoc.htm#PDDocGetSecurityData" title=" Superseded in Acrobat 5.0 by PDDocPermRequest."><code>PDDocGetSecurityData</code></a></div>
</div>

<H4><strong>Syntax</strong></H4>

<code><a href="aslayer_General.htm#ASBool" title=" ASBool"><code>ASBool</code></a> <code>PDCryptUpdateSecurityDataProc(</code><a href="pdlayer_PDDoc.htm#PDDoc" title=" The underlying PDF representation of a document."><code>PDDoc</code></a> <code>pdDoc</code><code>,</code> <a href="aslayer_ASAtom.htm#ASAtom"><code>ASAtom</code></a> <code>*</code><code>cryptHandler</code><code>,</code> <code>void</code> <code>*</code><code>*</code><code>secDataP</code><code>);</code> </code>

<H4><strong>Parameters</strong></H4>

<Table class="paramsTable"><tr><td><span><code>pdDoc</code></span>
</td><td><span>The document whose security data is updated. </span>
</td></tr>
<tr><td><span><code>cryptHandler</code></span>
</td><td><span>The current security handler for <code>pdDoc</code>. It can be modified to change the security handler. Encryption is turned off if <a href="aslayer_ASAtom.htm#ASAtomNull">ASAtomNull</a> is set. </span>
</td></tr>
<tr><td><span><code>secDataP</code></span>
</td><td><span>(Required) A security data structure. Its content and organization is up to the security handler. </span>
</td></tr></Table>

<H4><strong>Returns</strong></H4>

<span><a href="aslayer_General.htm#true"><code>true</code></a> unless the operation should be cancelled (for example, the user clicked on the Cancel button). </span>

<H4><strong>Used In</strong></H4>

<nav><table><tr><td><a href="pdlayer_PDCrypt.htm#_t_PDCryptHandler" title=" A data structure containing callbacks that implement a security handler."><code>_t_PDCryptHandler</code></a></td><td><span></span>
</td></tr></table>
</nav>
</section>
<section><div class="infoRow"><h3 id="PDCryptValidateSecurityDataProc"><strong><span style="color:grey;">PDCryptValidateSecurityDataProc</span></strong></h3>

<div class="headerRef"><strong>Header:</strong> PDExpT.h:4416</div>
</div>

<div><div><H4><strong>Description</strong></H4>

<div><p>(Optional) A callback for <a href="pdlayer_PDCrypt.htm#_t_PDCryptHandler">PDCryptHandler</a>. It validates the security data structure, which specifies the user's permissions. This callback may modify the security data structure (for example, because the user is not authorized to change the security as they requested). A client may have called <a href="pdlayer_PDDoc.htm#PDDocNewSecurityData" title=" Creates a security data structure appropriate for the specified document's new security handler.">PDDocNewSecurityData</a>() to obtain a new security data structure, then modified it, and then called <a href="pdlayer_PDDoc.htm#PDDocSetNewSecurityData" title=" Sets the security data structure for the specified document's new security handler.">PDDocSetNewSecurityData</a>() to change the document security. This callback should be called before actually setting the document's security data.<br/>
<p>This callback is not called automatically by the Acrobat viewer. It must be called, if desired, by the security handler's <a href="pdlayer_PDCrypt.htm#PDCryptUpdateSecurityDataProc" title=" A callback for PDCryptHandler.">PDCryptUpdateSecurityDataProc</a>().<br/></p>
</div>
</div>

<div class="relatedMethods"><H4><strong>Related Methods</strong></H4>

<a href="pdlayer_PDCrypt.htm#PDCryptUpdateSecurityDataProc" title=" A callback for PDCryptHandler."><code>PDCryptUpdateSecurityDataProc</code></a>
<a href="pdlayer_PDDoc.htm#PDDocNewSecurityData" title=" Creates a security data structure appropriate for the specified document's new security handler."><code>PDDocNewSecurityData</code></a>
<a href="pdlayer_PDDoc.htm#PDDocSetNewSecurityData" title=" Sets the security data structure for the specified document's new security handler."><code>PDDocSetNewSecurityData</code></a></div>
</div>

<H4><strong>Syntax</strong></H4>

<code><code>void</code> <code>PDCryptValidateSecurityDataProc(</code><a href="pdlayer_PDDoc.htm#PDDoc" title=" The underlying PDF representation of a document."><code>PDDoc</code></a> <code>pdDoc</code><code>,</code> <code>void</code> <code>*</code><code>secData</code><code>);</code> </code>

<H4><strong>Parameters</strong></H4>

<Table class="paramsTable"><tr><td><span><code>pdDoc</code></span>
</td><td><span>IN/OUT The document whose security data is validated. </span>
</td></tr>
<tr><td><span><code>secData</code></span>
</td><td><span>IN/OUT (May be modified by the callback) The document's security data. </span>
</td></tr></Table>

<H4><strong>Used In</strong></H4>

<nav><table><tr><td><a href="pdlayer_PDCrypt.htm#_t_PDCryptHandler" title=" A data structure containing callbacks that implement a security handler."><code>_t_PDCryptHandler</code></a></td><td><span></span>
</td></tr></table>
</nav>
</section>
</section>
<section id="Structures">
<header><h2>PDCrypt Structures</h2></header>
<nav><dl>
<dt><a href="#_t_PDCryptBatchHandler">_t_PDCryptBatchHandler</a></dt><dd> -  Callbacks used to open secured files and to modify security settings while batch processing a list of files.</dd>
<dt><a href="#_t_PDCryptFilterHandler">_t_PDCryptFilterHandler</a></dt><dd> -  PDCrypt Filter support.</dd>
<dt><a href="#_t_PDCryptHandler">_t_PDCryptHandler</a></dt><dd> -  A data structure containing callbacks that implement a security handler.</dd>
</dl></nav>
<section><div class="infoRow"><h3 id="_t_PDCryptBatchHandler"><strong><span style="color:grey;">_t_PDCryptBatchHandler</span></strong></h3>

<div class="headerRef"><strong>Header:</strong> PDExpT.h:5007</div>
</div>

<div><div><H4><strong>Description</strong></H4>

<span>Callbacks used to open secured files and to modify security settings while batch processing a list of files. These callbacks are not called while opening files through the user interface. In addition, the regular <a href="pdlayer_PDCrypt.htm#_t_PDCryptHandler">PDCryptHandler</a> functions are not called during batch operations. </span>
</div>

<div class="relatedMethods"><H4><strong>Related Methods</strong></H4>

<a href="pdlayer_PDCrypt.htm#PDRegisterCryptHandler" title=" Registers a new security handler with the Acrobat viewer."><code>PDRegisterCryptHandler</code></a>
<a href="pdlayer_PDCrypt.htm#PDRegisterCryptHandlerEx" title=" Registers a new security handler with the Acrobat viewer."><code>PDRegisterCryptHandlerEx</code></a></div>
</div>

<H4><strong>Syntax</strong></H4>

<div><table><tr><td><code><code>struct _t_PDCryptBatchHandler {</code> </code>
</td><td><span></span>
</td></tr>
<tr><td><div class="structMember"><a href="aslayer_General.htm#ASSize_t"><code>ASSize_t</code></a> <code>size</code><code>;</code> </div>
</td><td><span>Set this to <code>sizeof(PDCryptBatchHandlerRec)</code>. </span>
</td></tr>
<tr><td><div class="structMember"><a href="pdlayer_PDCrypt.htm#PDCryptBatchShowDialogProc" title=" A callback for PDCryptBatchHandler."><code>PDCryptBatchShowDialogProc</code></a> <code>BatchShowDialog</code><code>;</code> </div>
</td><td><span>This function should display a dialog box that allows a user to enter data that will be used to batch secure a series of files. The data is stored in an <a href="aslayer_ASCab.htm#ASCab" title=" ASCab objects ( cabinets ) can be used to store arbitrary key/value pairs.">ASCab</a> which is part of a Batch sequence file. The actual security data, including password(s), should be stored as a pointer in the ASCabinet so that password information is not serialized to disk. Pointers are not serialized from <a href="aslayer_ASCab.htm#ASCab" title=" ASCab objects ( cabinets ) can be used to store arbitrary key/value pairs.">ASCab</a> objects, but <a href="aslayer_ASText.htm#ASText" title=" An opaque object holding encoded text.">ASText</a> objects, <a href="aslayer_General.htm#ASInt32" title=" 4-byte signed long numeric value.">ASInt32</a> objects, and <a href="aslayer_General.htm#ASBool" title=" ASBool">ASBool</a> objects are serialized. </span>
</td></tr>
<tr><td><div class="structMember"><a href="pdlayer_PDCrypt.htm#PDCryptBatchParamDescProc" title=" A callback for PDCryptBatchHandler."><code>PDCryptBatchParamDescProc</code></a> <code>BatchParamDesc</code><code>;</code> </div>
</td><td><span>The developer should provide information about the current batch settings for the security handler. Batch settings are provided as a read-only <a href="aslayer_ASCab.htm#ASCab" title=" ASCab objects ( cabinets ) can be used to store arbitrary key/value pairs.">ASCab</a> which is passed in to the function. A writeable <a href="aslayer_ASCab.htm#ASCab" title=" ASCab objects ( cabinets ) can be used to store arbitrary key/value pairs.">ASCab</a> is also provided, which should be used to store parameter information about the security handler. The description information should be stored starting in the <code>paramDesc</code> <a href="aslayer_ASCab.htm#ASCab" title=" ASCab objects ( cabinets ) can be used to store arbitrary key/value pairs.">ASCab</a> using <a href="aslayer_ASText.htm#ASText" title=" An opaque object holding encoded text.">ASText</a> objects starting with key <code>"1"</code>. </span>
</td></tr>
<tr><td><div class="structMember"><a href="pdlayer_PDCrypt.htm#PDCryptBatchNewAuthDataProc" title=" A callback for PDCryptBatchHandler."><code>PDCryptBatchNewAuthDataProc</code></a> <code>BatchNewAuthData</code><code>;</code> </div>
</td><td><div><p>This is different from the regular <a href="pdlayer_PDCrypt.htm#_t_PDCryptHandler">PDCryptHandler</a> <code>NewAuthData</code> function. It creates and returns a <code>void</code> <code>*</code> which is the authorization data for the batch security handler. This data should be used to batch both open files and secure files. Therefore, make sure to provide password information for both the <a href="pdlayer_PDDoc.htm#pdPermOpen" title=" The user can open and decrypt the document."><code>pdPermOpen</code></a> and <a href="pdlayer_PDDoc.htm#pdPermSecure" title=" The user can change the document's security settings."><code>pdPermSecure</code></a> cases, and pass to <code>Authorize</code> and eventually to <a href="aslayer_ASMem.htm#ASfree" title=" Frees the specified memory block.">ASfree</a>().<br/>
<p>This authorization data is collected before any files are opened in the Batch sequence. It is permitted to display a user interface at this point since the Batch operation has not started yet. The data applies to all files, and therefore could represent one or more passwords which can be enumerated in the <code>BatchAuthorize</code> function which receives the Batch <code>authData</code>.<br/></p>
</div>
</td></tr>
<tr><td><div class="structMember"><a href="pdlayer_PDCrypt.htm#PDCryptBatchAuthorizeProc" title=" A callback for PDCryptBatchHandler."><code>PDCryptBatchAuthorizeProc</code></a> <code>BatchAuthorize</code><code>;</code> </div>
</td><td><span>Called when a PDF file is opened. It is first called with <a href="aslayer_General.htm#NULL"><code>NULL</code></a> <code>authData</code> for the case without a user password. It is called again with authorization data provided for the security handler that matches the one used in the PDF file. During a Batch operation, a file will first be opened with the <a href="pdlayer_PDDoc.htm#pdPermSecure" title=" The user can change the document's security settings."><code>pdPermSecure</code></a> bit set. It will then be opened with the <a href="pdlayer_PDDoc.htm#pdPermOpen" title=" The user can open and decrypt the document."><code>pdPermOpen</code></a> bit set. </span>
</td></tr>
<tr><td><div class="structMember"><a href="pdlayer_PDCrypt.htm#PDCryptBatchFreeAuthDataProc" title=" A callback for PDCryptBatchHandler."><code>PDCryptBatchFreeAuthDataProc</code></a> <code>BatchFreeAuthData</code><code>;</code> </div>
</td><td><span>If provided, this must be used to free the <code>authData</code> acquired via <code>BatchGetAuthData</code> or <code>BatchNewAuthData</code>. If no <code>BatchFreeAuthData</code> function is provided, a default one will be used which calls <a href="aslayer_ASMem.htm#ASfree" title=" Frees the specified memory block.">ASfree</a>() on the <code>authData</code> if it is non- <a href="aslayer_General.htm#NULL"><code>NULL</code></a>. </span>
</td></tr>
<tr><td><div class="structMember"><a href="pdlayer_PDCrypt.htm#PDCryptBatchUpdateSecurityDataProc" title=" A callback for PDCryptBatchHandler."><code>PDCryptBatchUpdateSecurityDataProc</code></a> <code>BatchUpdateSecurityData</code><code>;</code> </div>
</td><td><span>This function should update the crypt handler's security data without bringing up a dialog. This data is provided by a PDCryptShowBatchDialogProc(). The current security data can be obtained by calling <a href="pdlayer_PDDoc.htm#PDDocGetNewSecurityData" title=" Gets the security data structure for the specified document's new security handler.">PDDocGetNewSecurityData</a>(). This function should return <a href="aslayer_General.htm#true"><code>true</code></a> unless there is a problem with the batch data for this security handler. </span>
</td></tr>
<tr><td><div class="structMember"><a href="pdlayer_PDCrypt.htm#PDCryptBatchPreSequenceProc" title=" A callback for PDCryptBatchHandler."><code>PDCryptBatchPreSequenceProc</code></a> <code>BatchPreSequence</code><code>;</code> </div>
</td><td><div><p>This function is called at the beginning of a Batch sequence before any files have been opened. This allows a security handler to be called back with the <a href="aslayer_ASCab.htm#ASCab" title=" ASCab objects ( cabinets ) can be used to store arbitrary key/value pairs.">ASCab</a> of settings that were filled out by the BatchShowDialog() function, or by an ASCabinet that was read in from disk. Pointers of security information are not serialized to disk, and therefore a security information structure may need to be regenerated based on other security information in the ASCabinet.<br/>
<p>It is permitted for the <code>BatchPreSequence</code> callback to display a user interface asking the user for more information since the Batch sequence has not started yet.<br/></p>

<p>
<p>If this function returns <a href="aslayer_General.htm#false"><code>false</code></a>, the viewer will assume that the command cannot be executed, and will cancel the sequence.<br/></p>
</div>
</td></tr>
<tr><td><div class="structMember"><a href="pdlayer_PDCrypt.htm#PDCryptBatchPostSequenceProc" title=" A callback for PDCryptBatchHandler."><code>PDCryptBatchPostSequenceProc</code></a> <code>BatchPostSequence</code><code>;</code> </div>
</td><td><span>This function is called at the end of a Batch sequence after all files have been processed. Any memory that was allocated in the <code>BatchPreSequence</code> call should be cleaned up in this callback. </span>
</td></tr>
<tr><td><code id="PDCryptBatchHandlerRec"><code>}</code> <a href="pdlayer_PDCrypt.htm#_t_PDCryptBatchHandler" title=" Callbacks used to open secured files and to modify security settings while batch processing a list of files."><code>PDCryptBatchHandlerRec</code></a><code>;</code> </code>
</td><td><span></span>
</td></tr></table>
</div>

<H4><strong>Used In</strong></H4>

<nav><table><tr><td><a href="pdlayer_PDCrypt.htm#_t_PDCryptBatchHandler"><code>PDCryptBatchHandler</code></a></td><td><a href="pdlayer_PDCrypt.htm#_t_PDCryptHandler" title=" A data structure containing callbacks that implement a security handler."><code>_t_PDCryptHandler</code></a></td></tr></table>
</nav>
</section>
<section><div class="infoRow"><h3 id="_t_PDCryptFilterHandler"><strong><span style="color:grey;">_t_PDCryptFilterHandler</span></strong></h3>

<div class="headerRef"><strong>Header:</strong> PDExpT.h:4980</div>
</div>

<div><H4><strong>Description</strong></H4>

<div><UL>PDCrypt Filter support:<br/><li> Encryption callback routines are optional. However, the security handler is responsible for not allowing the application to cause a Full Save.<br/><li> String encryption/decryption support is not required.<br/><li> The <code>DecryptStream</code> callback can be <a href="aslayer_General.htm#NULL"><code>NULL</code></a> if the crypt filter handler does not perform encryption/decryption on its own. In such cases, <code>GetDataProc</code> must be supplied.<br/><li> Crypt Filter handlers are expected to return <code>0</code> length buffer (or EOF) when unauthorized access is made.<br/></UL>

<p>
<p>The <code>CryptStringProcs</code> string callback is expected to return the desired buffer size (the required destination buffer length) when <a href="aslayer_General.htm#NULL"><code>NULL</code></a> is passed as the destination buffer. This mechanism is to allow a different buffer length upon encryption/decryption.<br/></p>

<p>
<p>About the <a href="aslayer_ASCryptStm.htm#_t_ASCryptStmRec" title=" An ASStm object cover used for a cryptographic filter's stream callbacks.">ASCryptStm</a> in the callback: upon the first call (back) to Encrypt/Decrypt stream procs, the handler is expected to fill out an <a href="aslayer_ASCryptStm.htm#_t_ASCryptStmRec" title=" An ASStm object cover used for a cryptographic filter's stream callbacks.">ASCryptStmRec</a>. <a href="aslayer_ASCryptStm.htm#_t_ASCryptStmRec" title=" An ASStm object cover used for a cryptographic filter's stream callbacks.">ASCryptStm</a> has pointers to callback routines for various stream access. Subsequent stream access is made to these callback routines. See ASExpT.h for the <a href="aslayer_ASCryptStm.htm#_t_ASCryptStmRec" title=" An ASStm object cover used for a cryptographic filter's stream callbacks.">ASCryptStmRec</a> definition.<br/></p>
</div>
</div>

<H4><strong>Syntax</strong></H4>

<div><table><tr><td><code><code>struct _t_PDCryptFilterHandler {</code> </code>
</td><td><span></span>
</td></tr>
<tr><td><div class="structMember"><a href="aslayer_General.htm#ASSize_t"><code>ASSize_t</code></a> <code>size</code><code>;</code> </div>
</td><td><span>Set this to <code>sizeof(PDCryptFilterHandlerRec)</code>. </span>
</td></tr>
<tr><td><div class="structMember"><a href="pdlayer_PDCrypt.htm#PDCryptFilterAuthorizeProc" title=" (Optional) A callback for PDCryptFilterHandler."><code>PDCryptFilterAuthorizeProc</code></a> <code>Authorize</code><code>;</code> </div>
</td><td><span></span>
</td></tr>
<tr><td><div class="structMember"><a href="pdlayer_PDCrypt.htm#PDCryptFilterGetDataProc" title=" (Optional) A callback for PDCryptFilterHandler."><code>PDCryptFilterGetDataProc</code></a> <code>GetData</code><code>;</code> </div>
</td><td><span>Called to get crypt data when the application's built-in method is used. </span>
</td></tr>
<tr><td><div class="structMember"><a href="pdlayer_PDCrypt.htm#PDCryptFilterStreamProc" title=" (Optional) A callback for PDCryptFilterHandler."><code>PDCryptFilterStreamProc</code></a> <code>DecryptStream</code><code>;</code> </div>
</td><td><span></span>
</td></tr>
<tr><td><div class="structMember"><a href="pdlayer_PDCrypt.htm#PDCryptFilterStreamProc" title=" (Optional) A callback for PDCryptFilterHandler."><code>PDCryptFilterStreamProc</code></a> <code>EncryptStream</code><code>;</code> </div>
</td><td><span></span>
</td></tr>
<tr><td><div class="structMember"><a href="pdlayer_PDCrypt.htm#PDCryptFilterStringProc"><code>PDCryptFilterStringProc</code></a> <code>DecryptString</code><code>;</code> </div>
</td><td><span></span>
</td></tr>
<tr><td><div class="structMember"><a href="pdlayer_PDCrypt.htm#PDCryptFilterStringProc"><code>PDCryptFilterStringProc</code></a> <code>EncryptString</code><code>;</code> </div>
</td><td><span></span>
</td></tr>
<tr><td><code id="PDCryptFilterHandlerRec"><code>}</code> <a href="pdlayer_PDCrypt.htm#_t_PDCryptFilterHandler" title=" PDCrypt Filter support."><code>PDCryptFilterHandlerRec</code></a><code>;</code> </code>
</td><td><span></span>
</td></tr></table>
</div>

<H4><strong>Used In</strong></H4>

<nav><table><tr><td><a href="pdlayer_PDCrypt.htm#_t_PDCryptFilterHandler"><code>PDCryptFilterHandler</code></a></td><td><a href="pdlayer_PDCrypt.htm#_t_PDCryptHandler" title=" A data structure containing callbacks that implement a security handler."><code>_t_PDCryptHandler</code></a></td></tr></table>
</nav>
</section>
<section><div class="infoRow"><h3 id="_t_PDCryptHandler"><strong><span style="color:grey;">_t_PDCryptHandler</span></strong></h3>

<div class="headerRef"><strong>Header:</strong> PDExpT.h:5101</div>
</div>

<div><div><H4><strong>Description</strong></H4>

<span>A data structure containing callbacks that implement a security handler. The callbacks implement the security handler functions. For example, they get authorization data such as a password from the user, set permissions, read and write security-related data in a PDF file, and so on. </span>
</div>

<div class="relatedMethods"><H4><strong>Related Methods</strong></H4>

<a href="pdlayer_PDCrypt.htm#PDRegisterCryptHandler" title=" Registers a new security handler with the Acrobat viewer."><code>PDRegisterCryptHandler</code></a>
<a href="pdlayer_PDCrypt.htm#PDRegisterCryptHandlerEx" title=" Registers a new security handler with the Acrobat viewer."><code>PDRegisterCryptHandlerEx</code></a></div>
</div>

<H4><strong>Syntax</strong></H4>

<div><table><tr><td><code><code>struct _t_PDCryptHandler {</code> </code>
</td><td><span></span>
</td></tr>
<tr><td><div class="structMember"><a href="aslayer_General.htm#ASSize_t"><code>ASSize_t</code></a> <code>size</code><code>;</code> </div>
</td><td><span>Set this to <code>sizeof(PDCryptHandlerRec)</code>. <a href="pdlayer_PDCrypt.htm#PDRegisterCryptHandler" title=" Registers a new security handler with the Acrobat viewer.">PDRegisterCryptHandler</a> uses this to determine if the caller was compiled with an old version of this structure declaration. <a href="pdlayer_PDCrypt.htm#PDRegisterCryptHandler" title=" Registers a new security handler with the Acrobat viewer.">PDRegisterCryptHandler</a>() will raise <code>genErrBadParam</code> if the size does not correspond to a known size of this <code>struct</code>. </span>
</td></tr>
<tr><td><div class="structMember"><a href="pdlayer_PDCrypt.htm#PDCryptAuthorizeProc" title=" A callback for PDCryptHandler."><code>PDCryptAuthorizeProc</code></a> <code>Authorize</code><code>;</code> </div>
</td><td><div><p>This function will be called when a user tries to open or set security for an encrypted document. <code>PermsWanted</code> will be either <a href="pdlayer_PDDoc.htm#pdPermOpen" title=" The user can open and decrypt the document."><code>pdPermOpen</code></a> or <a href="pdlayer_PDDoc.htm#pdPermSecure" title=" The user can change the document's security settings."><code>pdPermSecure</code></a>. This function should return the permissions granted based on the <code>authData</code>. For opening, the permissions returned usually should be <a href="pdlayer_PDDoc.htm#pdPermOpen" title=" The user can open and decrypt the document."><code>pdPermOpen</code></a> and some or all of <a href="pdlayer_PDDoc.htm#pdPermPrint" title=" The user can print the document."><code>pdPermPrint</code></a>, <a href="pdlayer_PDDoc.htm#pdPermEdit" title=" The user can edit the document more than adding or modifying text notes (see also pdPermEditNotes)."><code>pdPermEdit</code></a>, and <a href="pdlayer_PDDoc.htm#pdPermCopy" title=" The user can copy information from the document to the clipboard."><code>pdPermCopy</code></a>. For setting security, permissions returned should be <a href="pdlayer_PDDoc.htm#pdPermAll"><code>pdPermAll</code></a>. However, if authorization fails, <code>0</code> should be returned. The function is first called with <code>authData</code> equal to <a href="aslayer_General.htm#NULL"><code>NULL</code></a>. If that fails, <code>GetAuthData</code> is called and the <code>authData</code> from it is passed to <code>Authorize</code>.<br/>
<p>If this function is called to authorize Open, decryption will not yet have been installed. So while any part of the document may be examined, some calls must be avoided. For example, a call that causes a page to be parsed will probably result in an error since the encrypted contents will be parsed. In general, it is safe to obtain information about the presence or absence of things, or the number of things, and to examine any part of a document at the Cos level.<br/></p>
</div>
</td></tr>
<tr><td><div class="structMember"><a href="pdlayer_PDCrypt.htm#PDCryptNewAuthDataProc" title=" (Optional) A callback for PDCryptHandler."><code>PDCryptNewAuthDataProc</code></a> <code>NewAuthData</code><code>;</code> </div>
</td><td><span>Creates and returns a new <code>struct</code> that can be filled out and passed to <code>Authorize</code> and eventually to <a href="aslayer_ASMem.htm#ASfree" title=" Frees the specified memory block.">ASfree</a>(). This function is not called by the standard security mechanism but may be called by extensions that want to gain access to a protected document. This function need not be implemented if clients can simply allocate data using <a href="aslayer_ASMem.htm#ASmalloc" title=" Allocates and returns a pointer to a memory block containing the specified number of bytes.">ASmalloc</a>(). In fact, the standard CryptHandler does not. </span>
</td></tr>
<tr><td><div class="structMember"><a href="pdlayer_PDCrypt.htm#PDCryptGetAuthDataProc" title=" A callback for PDCryptHandler."><code>PDCryptGetAuthDataProc</code></a> <code>GetAuthData</code><code>;</code> </div>
</td><td><span>This function obtains authorization data from the user. As with <code>Authorize</code>, <code>permsWanted</code> will be either <a href="pdlayer_PDDoc.htm#pdPermOpen" title=" The user can open and decrypt the document."><code>pdPermOpen</code></a> or <a href="pdlayer_PDDoc.htm#pdPermSecure" title=" The user can change the document's security settings."><code>pdPermSecure</code></a>. This function should allocate <code>authData</code> to be used by <code>Authorize</code>. The function should return <a href="aslayer_General.htm#true"><code>true</code></a> unless the operation should be cancelled (for example, if the user cancels a dialog). A crypt handler can specify the standard password dialog box by using AVCryptGetPassword(). In this case, the <code>authData</code> will be a <code>char</code> <code>*</code> that should be freed using <a href="aslayer_ASMem.htm#ASfree" title=" Frees the specified memory block.">ASfree</a>() after <code>Authorize</code> is called. </span>
</td></tr>
<tr><td><div class="structMember"><a href="pdlayer_PDCrypt.htm#PDCryptNewSecurityDataProc" title=" (Optional) A callback for PDCryptHandler."><code>PDCryptNewSecurityDataProc</code></a> <code>NewSecurityData</code><code>;</code> </div>
</td><td><span>Creates a new <code>struct</code> that contains information corresponding to information in the security dialog. If <code>encryptDict</code> is a dictionary, initialize the security data to correspond to the dictionary. Otherwise, set up defaults. This function will be called when opening a document with <code>encryptDict</code> set to the document's <code>encryptDict</code>. It will also be called when a user chooses new encryption. </span>
</td></tr>
<tr><td><div class="structMember"><a href="pdlayer_PDCrypt.htm#PDCryptValidateSecurityDataProc" title=" (Optional) A callback for PDCryptHandler."><code>PDCryptValidateSecurityDataProc</code></a> <code>ValidateSecurityData</code><code>;</code> </div>
</td><td><span>Validates the security data, modifying it as necessary. A client may have called <a href="pdlayer_PDDoc.htm#PDDocNewSecurityData" title=" Creates a security data structure appropriate for the specified document's new security handler.">PDDocNewSecurityData</a>() to obtain a new security data structure, then modified it, and then called <a href="pdlayer_PDDoc.htm#PDDocSetNewSecurityData" title=" Sets the security data structure for the specified document's new security handler.">PDDocSetNewSecurityData</a>() to change the document security. This is called before actually setting the document's security data. </span>
</td></tr>
<tr><td><div class="structMember"><a href="pdlayer_PDCrypt.htm#PDCryptUpdateSecurityDataProc" title=" A callback for PDCryptHandler."><code>PDCryptUpdateSecurityDataProc</code></a> <code>UpdateSecurityData</code><code>;</code> </div>
</td><td><span>This function should update the crypt handler's security data, usually by displaying a dialog. The current security data can be obtained by calling <a href="pdlayer_PDDoc.htm#PDDocGetNewSecurityData" title=" Gets the security data structure for the specified document's new security handler.">PDDocGetNewSecurityData</a>(). Like <code>GetAuthData</code>, this function should return <a href="aslayer_General.htm#true"><code>true</code></a> unless cancelled. The security data should be created with <a href="aslayer_ASMem.htm#ASmalloc" title=" Allocates and returns a pointer to a memory block containing the specified number of bytes.">ASmalloc</a>() so that it can later be freed by <a href="aslayer_ASMem.htm#ASfree" title=" Frees the specified memory block.">ASfree</a>(). The function can also update the <code>cryptHandler</code> itself. For example, the built-in encryption switches to no encryption if no passwords or permissions are set in the security dialog. </span>
</td></tr>
<tr><td><div class="structMember"><a href="pdlayer_PDCrypt.htm#PDCryptNewCryptDataProc" title=" A callback for PDCryptHandler."><code>PDCryptNewCryptDataProc</code></a> <code>NewCryptData</code><code>;</code> </div>
</td><td><span>Sets up the key to be passed to initialize the RC4 cipher for encryption and decryption. The length may not be greater than <code>5</code> to satisfy the current US export control regulations. Data should be allocated by <a href="aslayer_ASMem.htm#ASmalloc" title=" Allocates and returns a pointer to a memory block containing the specified number of bytes.">ASmalloc</a>() or a relative so that it may be freed by <a href="aslayer_ASMem.htm#ASfree" title=" Frees the specified memory block.">ASfree</a>(). </span>
</td></tr>
<tr><td><div class="structMember"><a href="pdlayer_PDCrypt.htm#PDCryptFillEncryptDictProc" title=" A callback for PDCryptHandler."><code>PDCryptFillEncryptDictProc</code></a> <code>FillEncryptDict</code><code>;</code> </div>
</td><td><span>This function should fill the encryption dictionary with whatever information is to be stored in the document. Unlike all other strings and streams, direct object elements of the encryption dictionary are not encrypted automatically. They must be encrypted before they are inserted into the dictionary. </span>
</td></tr>
<tr><td><div class="structMember"><a href="pdlayer_PDCrypt.htm#PDCryptGetSecurityInfoProc" title=" (Optional) A callback for PDCryptHandler."><code>PDCryptGetSecurityInfoProc</code></a> <code>GetSecurityInfo</code><code>;</code> </div>
</td><td><span>This function should return information about security for display to the user: whether the document has owner and user passwords and whether the user password enables printing, editing, copying text and graphics, and editing notes. See PDexpt.h for possible permissions. All other bits in <code>secInfo</code> should be set to <code>1</code>. This function is also used after a SaveAs to reset the permissions according to the current document. </span>
</td></tr>
<tr><td><div class="structMember"><a href="pdlayer_PDCrypt.htm#PDCryptFreeSecurityDataProc" title=" (Optional) A callback for PDCryptHandler."><code>PDCryptFreeSecurityDataProc</code></a> <code>FreeSecurityData</code><code>;</code> </div>
</td><td><span>If provided, this must be used to free <code>securityData</code> acquired via <code>NewSecurityData</code>. </span>
</td></tr>
<tr><td><div class="structMember"><a href="pdlayer_PDCrypt.htm#PDCryptFreeAuthDataProc" title=" (Optional) A callback for PDCryptHandler."><code>PDCryptFreeAuthDataProc</code></a> <code>FreeAuthData</code><code>;</code> </div>
</td><td><span>If provided, must be used to free <code>authData</code> acquired via <code>GetAuthData</code> or <code>NewAuthData</code>. </span>
</td></tr>
<tr><td><div class="structMember"><a href="pdlayer_PDCrypt.htm#PDCryptFreeCryptDataProc" title=" (Optional) A callback for PDCryptHandler."><code>PDCryptFreeCryptDataProc</code></a> <code>FreeCryptData</code><code>;</code> </div>
</td><td><span>If provided, this must be used to free <code>cryptData</code> acquired via <code>NewCryptData</code>. </span>
</td></tr>
<tr><td><div class="structMember"><a href="pdlayer_PDCrypt.htm#PDCryptNewCryptDataExProc" title=" A callback for PDCryptHandler."><code>PDCryptNewCryptDataExProc</code></a> <code>NewCryptDataEx</code><code>;</code> </div>
</td><td><span>Sets up the key to be passed to initialize the RC4 cipher and the version of algorithm for encryption and decryption. The key will be truncated when the length is greater than the viewer currently supports. Data will be freed by <code>FreeCryptData</code> if provided. Otherwise, <a href="aslayer_ASMem.htm#ASfree" title=" Frees the specified memory block.">ASfree</a>() is used. </span>
</td></tr>
<tr><td><div class="structMember"><a href="pdlayer_PDCrypt.htm#PDCryptAuthorizeExProc" title=" Replaces PDCryptAuthorizeProc."><code>PDCryptAuthorizeExProc</code></a> <code>AuthorizeEx</code><code>;</code> </div>
</td><td><span>This was added to replace <a href="pdlayer_PDCrypt.htm#PDCryptGetAuthDataProc" title=" A callback for PDCryptHandler.">PDCryptGetAuthDataProc</a>(). There are now new permission controls. <a href="pdlayer_PDDoc.htm#PDPerms" title=" Constant values that specify permissions which allow operations on a document file.">PDPerms</a> are obsolete. Yet, the viewer still supports the old security handler. It is called whenever the viewer needs to get authorization data and/or check permission for operation(s). </span>
</td></tr>
<tr><td><div class="structMember"><a href="pdlayer_PDCrypt.htm#PDCryptGetAuthDataExProc" title=" Replaces PDCryptGetAuthDataProc()."><code>PDCryptGetAuthDataExProc</code></a> <code>GetAuthDataEx</code><code>;</code> </div>
</td><td><span>This was added to replace <a href="pdlayer_PDCrypt.htm#PDCryptGetAuthDataProc" title=" A callback for PDCryptHandler.">PDCryptGetAuthDataProc</a>(). There are now new permission controls. <a href="pdlayer_PDDoc.htm#PDPerms" title=" Constant values that specify permissions which allow operations on a document file.">PDPerms</a> are obsolete. Yet, the viewer still supports the old security handler. It is called whenever the viewer needs to get authorization data and/or check permission for operation(s). </span>
</td></tr>
<tr><td><div class="structMember"><a href="pdlayer_PDCrypt.htm#PDCryptDisplaySecurityDataProc" title=" Called when the security handler should bring up a document (security) information dialog box with the current settings."><code>PDCryptDisplaySecurityDataProc</code></a> <code>DisplaySecurityData</code><code>;</code> </div>
</td><td><span>When the security handler is called, it should pop up a dialog box with current permission settings. This callback was added to provide the security handler with a way to display its custom permission settings. It should return <a href="aslayer_General.htm#true"><code>true</code></a> if it wants a callback to modify security settings. Otherwise, it should return <a href="aslayer_General.htm#false"><code>false</code></a>. </span>
</td></tr>
<tr><td><div class="structMember"><a href="pdlayer_PDCrypt.htm#PDCryptReservedProc" title=" (Optional) A callback for PDCryptHandler."><code>PDCryptReservedProc</code></a> <code>GetReservedData</code><code>;</code> </div>
</td><td><span>Used for the Acrobat Web Buy proprietary method of passing encrypted data. </span>
</td></tr>
<tr><td><div class="structMember"><a href="pdlayer_PDCrypt.htm#_t_PDCryptBatchHandler"><code>PDCryptBatchHandler</code></a> <code>CryptBatchHandler</code><code>;</code> </div>
</td><td><span>A pointer to the <a href="pdlayer_PDCrypt.htm#_t_PDCryptBatchHandler">PDCryptBatchHandler</a> structure. If this parameter is non- <a href="aslayer_General.htm#NULL"><code>NULL</code></a>, the security handler will work in a Batch environment, either for decrypting PDF files or encrypting them on Save with a new security handler. </span>
</td></tr>
<tr><td><div class="structMember"><a href="pdlayer_PDCrypt.htm#PDCryptCanParseEncryptDictProc" title=" (Optional) This call is used to provide PDCrypt handler interoperability."><code>PDCryptCanParseEncryptDictProc</code></a> <code>CanParseEncryptDict</code><code>;</code> </div>
</td><td><span>This call is used to provide PDCrypt handler interoperability. When an encrypted ducument is being opened and the security handler specified in the encryption dictionary is not present, the viewer will call this function on existing security handlers to see if one of them can be used to open the document. </span>
</td></tr>
<tr><td><div class="structMember"><a href="pdlayer_PDCrypt.htm#_t_PDCryptFilterHandler"><code>PDCryptFilterHandler</code></a> <code>CryptFilterHandler</code><code>;</code> </div>
</td><td><span>A pointer to the <a href="pdlayer_PDCrypt.htm#_t_PDCryptFilterHandler">PDCryptFilterHandler</a> structure. If this parameter is non- <a href="aslayer_General.htm#NULL"><code>NULL</code></a>, the security handler supports the Crypt Filter. </span>
</td></tr>
<tr><td><div class="structMember"><a href="pdlayer_PDCrypt.htm#PDCryptGetDocPermsProc" title=" A callback for PDCryptHandler."><code>PDCryptGetDocPermsProc</code></a> <code>GetDocPerms</code><code>;</code> </div>
</td><td><span>This function should return information about the document permissions for display to the user: whether the user can print, edit, copy text and graphics, edit notes and do form fill in and signing. See PDexpt.h for possible permissions. </span>
</td></tr>
<tr><td><div class="structMember"><a href="pdlayer_PDCrypt.htm#PDCryptEncryptDocMetadata" title=" (Optional) A callback for PDCryptHandler."><code>PDCryptEncryptDocMetadata</code></a> <code>EncryptDocMetadata</code><code>;</code> </div>
</td><td><span>It determines whether a document's metadata will be encrypted. If this call is not implemented, the metadata is always encrypted. </span>
</td></tr>
<tr><td><div class="structMember"><a href="pdlayer_PDCrypt.htm#PDCryptNewSecurityDataFromOriginalDocProc" title=" Called when the application needs to open a rolled back portion of the original document."><code>PDCryptNewSecurityDataFromOriginalDocProc</code></a> <code>NewSecurityDataFromOrgDoc</code><code>;</code> </div>
</td><td><div><p>Used for opening a rolled back document (the original portion of a signed document). If this call is not implemented, the security handler is asked for authorization. Since authorization is already requested for the document, this would be the second authorization call for the rolled back part.<br/>
<p>The callee is expected to authorize the opening of this document using an already opened document, including the subsequent callback to authorize the Crypt Filter(s).<br/></p>
</div>
</td></tr>
<tr><td><div class="structMember"><a href="pdlayer_PDCrypt.htm#PDCryptGetInfoTextProc" title=" (Optional) A callback for PDCryptHandler."><code>PDCryptGetInfoTextProc</code></a> <code>GetInfoText</code><code>;</code> </div>
</td><td><span>Used by Acrobat to display user interface information about the document. </span>
</td></tr>
<tr><td><div class="structMember"><a href="pdlayer_PDCrypt.htm#PDCryptReservedProc2" title=" (Optional) Used by Acrobat for Automated Permission Testing."><code>PDCryptReservedProc2</code></a> <code>SetTestPerms</code><code>;</code> </div>
</td><td><span></span>
</td></tr>
<tr><td><code id="PDCryptHandlerRec"><code>}</code> <a href="pdlayer_PDCrypt.htm#_t_PDCryptHandler" title=" A data structure containing callbacks that implement a security handler."><code>PDCryptHandlerRec</code></a><code>;</code> </code>
</td><td><span></span>
</td></tr></table>
</div>

<H4><strong>Used In</strong></H4>

<nav><table><tr><td><a href="pdlayer_PDCrypt.htm#_t_PDCryptHandler"><code>PDCryptHandler</code></a></td><td><span></span>
</td></tr></table>
</nav>
</section>
</section>
<section id="Functions">
<header><h2>PDCrypt Functions</h2></header>
<nav><dl>
<dt><a href="#PDCryptAuthorizeFilterAccess">PDCryptAuthorizeFilterAccess</a></dt><dd> -  Gets authorization to encrypt or decrypt an embedded file, where that file's cryptographic filter is not the one used to open the document in which the file is embedded.</dd>
<dt><a href="#PDRegisterCryptHandler">PDRegisterCryptHandler</a></dt><dd> -  Registers a new security handler with the Acrobat viewer.</dd>
<dt><a href="#PDRegisterCryptHandlerEx">PDRegisterCryptHandlerEx</a></dt><dd> -  Registers a new security handler with the Acrobat viewer.</dd>
</dl></nav>
<section><div class="infoRow"><h3 id="PDCryptAuthorizeFilterAccess"><strong><span style="color:grey;">PDCryptAuthorizeFilterAccess</span></strong></h3>

<div class="headerRef"><strong>Header:</strong> PDProcs.h:10378</div>
</div>

<div><div><H4><strong>Description</strong></H4>

<span>Gets authorization to encrypt or decrypt an embedded file, where that file's cryptographic filter is not the one used to open the document in which the file is embedded. </span>
</div>

<div class="relatedMethods"><H4><strong>Related Methods</strong></H4>

<a href="pdlayer_PDDoc.htm#PDDocSetNewCryptFilterData" title=" Sets the encrypted data for the specified document's encryption filter to decrypt."><code>PDDocSetNewCryptFilterData</code></a>
<a href="pdlayer_PDDoc.htm#PDDocSetNewCryptFilterMethod" title=" Sets or resets the specified document's security filter method, used for encryption and decryption of the document's data."><code>PDDocSetNewCryptFilterMethod</code></a>
<a href="pdlayer_PDDoc.htm#PDDocSetNewDefaultFilters" title=" Sets or resets the document's default security filter methods for streams and strings, used to encrypt and decrypt the document's data."><code>PDDocSetNewDefaultFilters</code></a></div>
</div>

<H4><strong>Syntax</strong></H4>

<code><a href="aslayer_General.htm#ASBool" title=" ASBool"><code>ASBool</code></a> <code>PDCryptAuthorizeFilterAccess(</code><a href="pdlayer_PDDoc.htm#PDDoc" title=" The underlying PDF representation of a document."><code>PDDoc</code></a> <code>doc</code><code>,</code> <a href="aslayer_ASAtom.htm#ASAtom"><code>ASAtom</code></a> <code>handlerName</code><code>,</code> <a href="aslayer_ASAtom.htm#ASAtom"><code>ASAtom</code></a> <code>filterName</code><code>,</code> <a href="aslayer_General.htm#ASBool" title=" ASBool"><code>ASBool</code></a> <code>bEncrypt</code><code>);</code> </code>

<H4><strong>Parameters</strong></H4>

<Table class="paramsTable"><tr><td><span><code>doc</code></span>
</td><td><span>The document containing the embedded file whose filter access is requested. </span>
</td></tr>
<tr><td><span><code>handlerName</code></span>
</td><td><span>The security handler containing the Authorize() callback procedure to run. </span>
</td></tr>
<tr><td><span><code>filterName</code></span>
</td><td><span>The <a href="aslayer_ASAtom.htm#ASAtom">ASAtom</a> corresponding to the name of the security filter used by the embedded file. </span>
</td></tr>
<tr><td><span><code>bEncrypt</code></span>
</td><td><span>When <a href="aslayer_General.htm#true"><code>true</code></a>, the access is required for an encryption operation. When <a href="aslayer_General.htm#false"><code>false</code></a>, it is a decryption operation. </span>
</td></tr></Table>

<H4><strong>Returns</strong></H4>

<span><a href="aslayer_General.htm#true"><code>true</code></a> if the authorization succeeds, <a href="aslayer_General.htm#false"><code>false</code></a> otherwise. </span>

<H4><strong>Exceptions</strong></H4>

<div><table><tr><td><span><a href="pdfllayer_General.htm#pdErrNoCryptHandler" title=" The security plug-in required by this command is unavailable."><code>pdErrNoCryptHandler</code></a></span>
</td><td><span>is raised if there is no security handler registered for the document. </span>
</td></tr></table>
</div>
</section>
<section><div class="infoRow"><h3 id="PDRegisterCryptHandler"><strong><span style="color:grey;">PDRegisterCryptHandler</span></strong></h3>

<div class="headerRef"><strong>Header:</strong> PDProcs.h:2484</div>
</div>

<div><div><H4><strong>Description</strong></H4>

<span>Registers a new security handler with the Acrobat viewer. </span>
</div>

<div class="relatedMethods"><H4><strong>Related Methods</strong></H4>

<a href="pdlayer_PDDoc.htm#PDDocGetNewCryptHandler" title=" Gets the specified document's new security handler (that is, the security handler that will be used after the document is saved)."><code>PDDocGetNewCryptHandler</code></a>
<a href="pdlayer_PDDoc.htm#PDDocPermRequest" title=" This method supersedes PDDocGetPermissions()."><code>PDDocPermRequest</code></a>
<a href="pdlayer_PDDoc.htm#PDDocSetNewCryptHandler" title=" Sets the specified document's new security handler (that is, the security handler that will be used after the document is saved)."><code>PDDocSetNewCryptHandler</code></a>
<a href="pdlayer_PDDoc.htm#PDDocSetNewCryptHandlerEx" title=" Extends PDDocSetNewCryptHandler() for Acrobat 6.0. It sets the specified document's new security handler (that is, the security handler that will be used after the document is saved)."><code>PDDocSetNewCryptHandlerEx</code></a>
<a href="pdlayer_PDCrypt.htm#PDRegisterCryptHandlerEx" title=" Registers a new security handler with the Acrobat viewer."><code>PDRegisterCryptHandlerEx</code></a></div>
</div>

<H4><strong>Syntax</strong></H4>

<code><code>void</code> <code>PDRegisterCryptHandler(</code><a href="pdlayer_PDCrypt.htm#_t_PDCryptHandler"><code>PDCryptHandler</code></a> <code>handler</code><code>,</code> <code>const</code> <code>char</code> <code>*</code><code>pdfName</code><code>,</code> <code>const</code> <code>char</code> <code>*</code><code>userName</code><code>);</code> </code>

<H4><strong>Parameters</strong></H4>

<Table class="paramsTable"><tr><td><span><code>handler</code></span>
</td><td><span>A pointer to a structure that contains the security handler's callback functions. This structure must not be freed after calling <a href="pdlayer_PDCrypt.htm#PDRegisterCryptHandler" title=" Registers a new security handler with the Acrobat viewer.">PDRegisterCryptHandler</a>(). </span>
</td></tr>
<tr><td><span><code>pdfName</code></span>
</td><td><span>The name of the security handler as it will appear in the PDF file. This name is also used by <a href="pdlayer_PDDoc.htm#PDDocSetNewCryptHandler" title=" Sets the specified document's new security handler (that is, the security handler that will be used after the document is saved).">PDDocSetNewCryptHandler</a>(). Storage for this name can be freed after <a href="pdlayer_PDCrypt.htm#PDRegisterCryptHandler" title=" Registers a new security handler with the Acrobat viewer.">PDRegisterCryptHandler</a>() has been called. </span>
</td></tr>
<tr><td><span><code>userName</code></span>
</td><td><span>The name of the security handler as it will be shown in menus. This name can be localized into different languages. Storage for this name can be freed after <a href="pdlayer_PDCrypt.htm#PDRegisterCryptHandler" title=" Registers a new security handler with the Acrobat viewer.">PDRegisterCryptHandler</a>() has been called. </span>
</td></tr></Table>

<H4><strong>Exceptions</strong></H4>

<div><table><tr><td><span><a href="pdfllayer_General.htm#genErrBadParm" title=" Bad parameter."><code>genErrBadParm</code></a></span>
</td><td><span>is raised if the security handler's size field is incorrect. </span>
</td></tr>
<tr><td><span><a href="pdfllayer_General.htm#ErrSysPDSEdit" title=" PDSEdit (structure) errors."><code>ErrSysPDSEdit</code></a></span>
</td><td><span>is raised if either <code>pdfName</code> or <code>userName</code> are already in use by a registered security handler. </span>
</td></tr>
<tr><td><span><a href="pdfllayer_General.htm#genErrNoMemory" title=" Out of memory."><code>genErrNoMemory</code></a></span>
</td><td><span>is raised is memory is exhausted. Other exceptions may be raised as well. </span>
</td></tr></table>
</div>
</section>
<section><div class="infoRow"><h3 id="PDRegisterCryptHandlerEx"><strong><span style="color:grey;">PDRegisterCryptHandlerEx</span></strong></h3>

<div class="headerRef"><strong>Header:</strong> PDProcs.h:5834</div>
</div>

<div><div><H4><strong>Description</strong></H4>

<span>Registers a new security handler with the Acrobat viewer. It is the same as <a href="pdlayer_PDCrypt.htm#PDRegisterCryptHandler" title=" Registers a new security handler with the Acrobat viewer.">PDRegisterCryptHandler</a>() except that it accepts a client data parameter. </span>
</div>

<div class="relatedMethods"><H4><strong>Related Methods</strong></H4>

<a href="pdlayer_PDDoc.htm#PDDocPermRequest" title=" This method supersedes PDDocGetPermissions()."><code>PDDocPermRequest</code></a>
<a href="pdlayer_PDDoc.htm#PDDocSetNewCryptHandler" title=" Sets the specified document's new security handler (that is, the security handler that will be used after the document is saved)."><code>PDDocSetNewCryptHandler</code></a>
<a href="pdlayer_PDCrypt.htm#PDRegisterCryptHandler" title=" Registers a new security handler with the Acrobat viewer."><code>PDRegisterCryptHandler</code></a></div>
</div>

<H4><strong>Syntax</strong></H4>

<code><code>void</code> <code>PDRegisterCryptHandlerEx(</code><a href="pdlayer_PDCrypt.htm#_t_PDCryptHandler"><code>PDCryptHandler</code></a> <code>handler</code><code>,</code> <code>const</code> <code>char</code> <code>*</code><code>pdfName</code><code>,</code> <code>const</code> <code>char</code> <code>*</code><code>userName</code><code>,</code> <code>void</code> <code>*</code><code>clientData</code><code>);</code> </code>

<H4><strong>Parameters</strong></H4>

<Table class="paramsTable"><tr><td><span><code>handler</code></span>
</td><td><span>A pointer to a structure that contains the security handler's callback functions. This structure must not be freed after calling <a href="pdlayer_PDCrypt.htm#PDRegisterCryptHandlerEx" title=" Registers a new security handler with the Acrobat viewer.">PDRegisterCryptHandlerEx</a>(). </span>
</td></tr>
<tr><td><span><code>pdfName</code></span>
</td><td><span>The name of the security handler as it will appear in the PDF file. This name is also used by <a href="pdlayer_PDDoc.htm#PDDocSetNewCryptHandler" title=" Sets the specified document's new security handler (that is, the security handler that will be used after the document is saved).">PDDocSetNewCryptHandler</a>(). Storage for this name can be freed after <a href="pdlayer_PDCrypt.htm#PDRegisterCryptHandlerEx" title=" Registers a new security handler with the Acrobat viewer.">PDRegisterCryptHandlerEx</a>() has been called. </span>
</td></tr>
<tr><td><span><code>userName</code></span>
</td><td><span>The name of the security handler as it will be shown in menus. This name can be localized to different languages. Storage for this name can be freed after <a href="pdlayer_PDCrypt.htm#PDRegisterCryptHandlerEx" title=" Registers a new security handler with the Acrobat viewer.">PDRegisterCryptHandlerEx</a>() has been called. </span>
</td></tr>
<tr><td><span><code>clientData</code></span>
</td><td><span>A pointer to user-supplied data to store with the handler. </span>
</td></tr></Table>

<H4><strong>Exceptions</strong></H4>

<div><table><tr><td><span><a href="pdfllayer_General.htm#genErrBadParm" title=" Bad parameter."><code>genErrBadParm</code></a></span>
</td><td><span>is raised if the security handler's size field is incorrect. </span>
</td></tr>
<tr><td><span><a href="pdfllayer_General.htm#ErrSysPDSEdit" title=" PDSEdit (structure) errors."><code>ErrSysPDSEdit</code></a></span>
</td><td><span>is raised if either pdfName or userName are already in use by a registered security handler. </span>
</td></tr>
<tr><td><span><a href="pdfllayer_General.htm#genErrNoMemory" title=" Out of memory."><code>genErrNoMemory</code></a></span>
</td><td><span>is raised is memory is exhausted. </span>
</td></tr></table>
</div>
</section>
</section>

</div>
</body></html>